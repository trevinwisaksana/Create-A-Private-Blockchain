{
  "{\"assumptions\":{},\"sourceRoot\":\"/Users/stockbit/Downloads/project_1_v2_boilerplate/src/\",\"caller\":{\"name\":\"@babel/node\"},\"configFile\":false,\"cwd\":\"/Users/stockbit/Downloads/project_1_v2_boilerplate\",\"filename\":\"/Users/stockbit/Downloads/project_1_v2_boilerplate/src/blockchain.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"production\",\"root\":\"/Users/stockbit/Downloads/project_1_v2_boilerplate\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":true,\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false}},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false}}],\"presets\":[]}:7.14.3:production": {
    "metadata": {},
    "options": {
      "assumptions": {},
      "sourceRoot": "/Users/stockbit/Downloads/project_1_v2_boilerplate/src/",
      "caller": {
        "name": "@babel/node"
      },
      "configFile": false,
      "cwd": "/Users/stockbit/Downloads/project_1_v2_boilerplate",
      "filename": "/Users/stockbit/Downloads/project_1_v2_boilerplate/src/blockchain.js",
      "targets": {},
      "cloneInputAst": true,
      "babelrc": false,
      "browserslistConfigFile": false,
      "envName": "production",
      "root": "/Users/stockbit/Downloads/project_1_v2_boilerplate",
      "rootMode": "root",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [
        {
          "key": "syntax-class-properties",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-numeric-separator",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-nullish-coalescing-operator",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-optional-chaining",
          "visitor": {
            "_exploded": true,
            "OptionalCallExpression": {
              "enter": [
                null
              ]
            },
            "OptionalMemberExpression": {
              "enter": [
                null
              ]
            },
            "_verified": true
          },
          "options": {
            "spec": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-json-strings",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-optional-catch-binding",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-async-generators",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-object-rest-spread",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-modules-commonjs",
          "visitor": {
            "CallExpression": {
              "enter": [
                null
              ]
            },
            "Program": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-dynamic-import",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "Program": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-export-namespace-from",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "ExportNamedDeclaration": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "useBuiltIns": false
          }
        }
      ],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "/Users/stockbit/Downloads/project_1_v2_boilerplate/src/blockchain.js",
        "plugins": [
          "classProperties",
          "classPrivateProperties",
          "classPrivateMethods",
          "numericSeparator",
          "nullishCoalescingOperator",
          "jsonStrings",
          "optionalCatchBinding",
          "asyncGenerators",
          "objectRestSpread",
          "dynamicImport",
          "exportNamespaceFrom"
        ]
      },
      "generatorOpts": {
        "filename": "/Users/stockbit/Downloads/project_1_v2_boilerplate/src/blockchain.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "/Users/stockbit/Downloads/project_1_v2_boilerplate/src/",
        "sourceFileName": "blockchain.js"
      }
    },
    "ast": null,
    "code": "\"use strict\";\n\n/**\n *                          Blockchain Class\n *  The Blockchain class contain the basics functions to create your own private blockchain\n *  It uses libraries like `crypto-js` to create the hashes for each block and `bitcoinjs-message`\n *  to verify a message signature. The chain is stored in the array\n *  `this.chain = [];`. Of course each time you run the application the chain will be empty because and array\n *  isn't a persisten storage method.\n *\n */\nconst SHA256 = require('crypto-js/sha256');\n\nconst BlockClass = require('./block.js');\n\nconst bitcoinMessage = require('bitcoinjs-message');\n\nclass Blockchain {\n  /**\n   * Constructor of the class, you will need to setup your chain array and the height\n   * of your chain (the length of your chain array).\n   * Also everytime you create a Blockchain class you will need to initialized the chain creating\n   * the Genesis Block.\n   * The methods in this class will always return a Promise to allow client applications or\n   * other backends to call asynchronous functions.\n   */\n  constructor() {\n    this.chain = [];\n    this.height = -1;\n    this.initializeChain();\n  }\n  /**\n   * This method will check for the height of the chain and if there isn't a Genesis Block it will create it.\n   * You should use the `addBlock(block)` to create the Genesis Block\n   * Passing as a data `{data: 'Genesis Block'}`\n   */\n\n\n  async initializeChain() {\n    if (this.height === -1) {\n      let block = new BlockClass.Block({\n        data: 'Genesis Block'\n      });\n      await this._addBlock(block);\n    }\n  }\n  /**\n   * Utility method that return a Promise that will resolve with the height of the chain\n   */\n\n\n  getChainHeight() {\n    return new Promise((resolve, reject) => {\n      resolve(this.height);\n    });\n  }\n  /**\n   * _addBlock(block) will store a block in the chain\n   * @param {*} block\n   * The method will return a Promise that will resolve with the block added\n   * or reject if an error happen during the execution.\n   * You will need to check for the height to assign the `previousBlockHash`,\n   * assign the `timestamp` and the correct `height`...At the end you need to\n   * create the `block hash` and push the block into the chain array. Don't for get\n   * to update the `this.height`\n   * Note: the symbol `_` in the method name indicates in the javascript convention\n   * that this method is a private method.\n   */\n\n\n  _addBlock(block) {\n    let self = this;\n    return new Promise(async (resolve, reject) => {\n      if (this.chain.length > 0) {\n        // previous block hash\n        block.previousBlockHash = this.chain[this.chain.length - 1].hash;\n      } // block height\n\n\n      block.height = this.chain.length; // UTC timestamp\n\n      block.time = new Date().getTime().toString().slice(0, -3); // SHA256 requires a string of data\n\n      block.hash = SHA256(JSON.stringify(block)).toString();\n      let validationErrors = await self.validateChain();\n\n      if (block.hash && validationErrors.length == 0) {\n        // add block to chain\n        self.chain.push(block);\n        self.height++;\n        resolve(block);\n      } else {\n        reject(\"Failed to add block\");\n      }\n    });\n  }\n  /**\n   * The requestMessageOwnershipVerification(address) method\n   * will allow you  to request a message that you will use to\n   * sign it with your Bitcoin Wallet (Electrum or Bitcoin Core)\n   * This is the first step before submit your Block.\n   * The method return a Promise that will resolve with the message to be signed\n   * @param {*} address\n   */\n\n\n  requestMessageOwnershipVerification(address) {\n    return new Promise(resolve => {\n      resolve(`${address}:${new Date().getTime().toString().slice(0, -3)}:starRegistry`);\n    });\n  }\n  /**\n   * The submitStar(address, message, signature, star) method\n   * will allow users to register a new Block with the star object\n   * into the chain. This method will resolve with the Block added or\n   * reject with an error.\n   * Algorithm steps:\n   * 1. Get the time from the message sent as a parameter example: `parseInt(message.split(':')[1])`\n   * 2. Get the current time: `let currentTime = parseInt(new Date().getTime().toString().slice(0, -3));`\n   * 3. Check if the time elapsed is less than 5 minutes\n   * 4. Veify the message with wallet address and signature: `bitcoinMessage.verify(message, address, signature)`\n   * 5. Create the block and add it to the chain\n   * 6. Resolve with the block added.\n   * @param {*} address\n   * @param {*} message\n   * @param {*} signature\n   * @param {*} star\n   */\n\n\n  submitStar(address, message, signature, star) {\n    let self = this;\n    return new Promise(async (resolve, reject) => {\n      let messageTime = parseInt(message.split(':')[1]);\n      let currentTime = parseInt(new Date().getTime().toString().slice(0, -3));\n      var FIVE_MIN = 5 * 60 * 1000;\n      let deadline = messageTime + FIVE_MIN;\n\n      if (deadline >= currentTime) {\n        if (bitcoinMessage.verify(message, address, signature)) {\n          let block = new BlockClass.Block({\n            owner: address,\n            star: star\n          });\n          let addedBlock = await self._addBlock(block);\n          resolve(addedBlock);\n        } else {\n          reject(\"Signature is not valid\");\n        }\n      } else {\n        reject(\"Time has elapsed more than 5 minutes\");\n      }\n    });\n  }\n  /**\n   * This method will return a Promise that will resolve with the Block\n   *  with the hash passed as a parameter.\n   * Search on the chain array for the block that has the hash.\n   * @param {*} hash\n   */\n\n\n  getBlockByHash(hash) {\n    let self = this;\n    return new Promise((resolve, reject) => {\n      let filteredResults = self.chain.array.filter(block => block.hash == hash);\n\n      if (filteredResults.length == 1) {\n        resolve(filteredResults[0]);\n      } else {\n        reject(\"Block does not exist\");\n      }\n    });\n  }\n  /**\n   * This method will return a Promise that will resolve with the Block object\n   * with the height equal to the parameter `height`\n   * @param {*} height\n   */\n\n\n  getBlockByHeight(height) {\n    let self = this;\n    return new Promise((resolve, reject) => {\n      let block = self.chain.filter(p => p.height === height)[0];\n\n      if (block) {\n        resolve(block);\n      } else {\n        resolve(null);\n      }\n    });\n  }\n  /**\n   * This method will return a Promise that will resolve with an array of Stars objects existing in the chain\n   * and are belongs to the owner with the wallet address passed as parameter.\n   * Remember the star should be returned decoded.\n   * @param {*} address\n   */\n\n\n  getStarsByWalletAddress(address) {\n    let self = this;\n    let stars = [];\n    return new Promise(async (resolve, reject) => {\n      self.chain.forEach(async block => {\n        let data = await block.getBData();\n        if (data.owner === address) stars.push(data);\n      });\n\n      if (stars.length == 0) {\n        resolve(stars);\n      } else {\n        reject(\"There is star asociated with this address ${address}\");\n      }\n    });\n  }\n  /**\n   * This method will return a Promise that will resolve with the list of errors when validating the chain.\n   * Steps to validate:\n   * 1. You should validate each block using `validateBlock`\n   * 2. Each Block should check the with the previousBlockHash\n   */\n\n\n  validateChain() {\n    let self = this;\n    let errorLog = [];\n    return new Promise(async (resolve, reject) => {\n      self.chain.forEach(block => {\n        let isValid = block.validate();\n\n        if (!isValid) {\n          errorLog.push(new Error('Hash of previous block do not match ${block.height}'));\n        }\n      });\n      resolve(errorLog);\n    });\n  }\n\n}\n\nmodule.exports.Blockchain = Blockchain;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImJsb2NrY2hhaW4uanMiXSwibmFtZXMiOlsiU0hBMjU2IiwicmVxdWlyZSIsIkJsb2NrQ2xhc3MiLCJiaXRjb2luTWVzc2FnZSIsIkJsb2NrY2hhaW4iLCJjb25zdHJ1Y3RvciIsImNoYWluIiwiaGVpZ2h0IiwiaW5pdGlhbGl6ZUNoYWluIiwiYmxvY2siLCJCbG9jayIsImRhdGEiLCJfYWRkQmxvY2siLCJnZXRDaGFpbkhlaWdodCIsIlByb21pc2UiLCJyZXNvbHZlIiwicmVqZWN0Iiwic2VsZiIsImxlbmd0aCIsInByZXZpb3VzQmxvY2tIYXNoIiwiaGFzaCIsInRpbWUiLCJEYXRlIiwiZ2V0VGltZSIsInRvU3RyaW5nIiwic2xpY2UiLCJKU09OIiwic3RyaW5naWZ5IiwidmFsaWRhdGlvbkVycm9ycyIsInZhbGlkYXRlQ2hhaW4iLCJwdXNoIiwicmVxdWVzdE1lc3NhZ2VPd25lcnNoaXBWZXJpZmljYXRpb24iLCJhZGRyZXNzIiwic3VibWl0U3RhciIsIm1lc3NhZ2UiLCJzaWduYXR1cmUiLCJzdGFyIiwibWVzc2FnZVRpbWUiLCJwYXJzZUludCIsInNwbGl0IiwiY3VycmVudFRpbWUiLCJGSVZFX01JTiIsImRlYWRsaW5lIiwidmVyaWZ5Iiwib3duZXIiLCJhZGRlZEJsb2NrIiwiZ2V0QmxvY2tCeUhhc2giLCJmaWx0ZXJlZFJlc3VsdHMiLCJhcnJheSIsImZpbHRlciIsImdldEJsb2NrQnlIZWlnaHQiLCJwIiwiZ2V0U3RhcnNCeVdhbGxldEFkZHJlc3MiLCJzdGFycyIsImZvckVhY2giLCJnZXRCRGF0YSIsImVycm9yTG9nIiwiaXNWYWxpZCIsInZhbGlkYXRlIiwiRXJyb3IiLCJtb2R1bGUiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiOztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBLE1BQU1BLE1BQU0sR0FBR0MsT0FBTyxDQUFDLGtCQUFELENBQXRCOztBQUNBLE1BQU1DLFVBQVUsR0FBR0QsT0FBTyxD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O0FBQ1JELFVBQUFBLFFBQVEsQ0FBQzFCLElBQVQsQ0FBYyxJQUFJNkIsS0FBSixDQUFVLHFEQUFWLENBQWQ7QUFDSDtBQUNKLE9BTkQ7QUFRQTVDLE1BQUFBLE9BQU8sQ0FBQ3lDLFFBQUQsQ0FBUDtBQUNILEtBVk0sQ0FBUDtBQVdIOztBQW5OWTs7QUF1TmpCSSxNQUFNLENBQUNDLE9BQVAsQ0FBZXpELFVBQWYsR0FBNEJBLFVBQTVCIiwic291cmNlUm9vdCI6Ii9Vc2Vycy9zdG9ja2JpdC9Eb3dubG9hZHMvcHJvamVjdF8xX3YyX2JvaWxlcnBsYXRlL3NyYy8iLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqICAgICAgICAgICAgICAgICAgICAgICAgICBCbG9ja2NoYWluIENsYXNzXG4gKiAgVGhlIEJsb2NrY2hhaW4gY2xhc3MgY29udGFpbiB0aGUgYmFzaWNzIGZ1bmN0aW9ucyB0byBjcmVhdGUgeW91ciBvd24gcHJpdmF0ZSBibG9ja2NoYWluXG4gKiAgSXQgdXNlcyBsaWJyYXJpZXMgbGlrZSBgY3J5cHRvLWpzYCB0byBjcmVhdGUgdGhlIGhhc2hlcyBmb3IgZWFjaCBibG9jayBhbmQgYGJpdGNvaW5qcy1tZXNzYWdlYFxuICogIHRvIHZlcmlmeSBhIG1lc3NhZ2Ugc2lnbmF0dXJlLiBUaGUgY2hhaW4gaXMgc3RvcmVkIGluIHRoZSBhcnJheVxuICogIGB0aGlzLmNoYWluID0gW107YC4gT2YgY291cnNlIGVhY2ggdGltZSB5b3UgcnVuIHRoZSBhcHBsaWNhdGlvbiB0aGUgY2hhaW4gd2lsbCBiZSBlbXB0eSBiZWNhdXNlIGFuZCBhcnJheVxuICogIGlzbid0IGEgcGVyc2lzdGVuIHN0b3JhZ2UgbWV0aG9kLlxuICpcbiAqL1xuXG5jb25zdCBTSEEyNTYgPSByZXF1aXJlKCdjcnlwdG8tanMvc2hhMjU2Jyk7XG5jb25zdCBCbG9ja0NsYXNzID0gcmVxdWlyZSgnLi9ibG9jay5qcycpO1xuY29uc3QgYml0Y29pbk1lc3NhZ2UgPSByZXF1aXJlKCdiaXRjb2luanMtbWVzc2FnZScpO1xuXG5jbGFzcyBCbG9ja2NoYWluIHtcblxuICAgIC8qKlxuICAgICAqIENvbnN0cnVjdG9yIG9mIHRoZSBjbGFzcywgeW91IHdpbGwgbmVlZCB0byBzZXR1cCB5b3VyIGNoYWluIGFycmF5IGFuZCB0aGUgaGVpZ2h0XG4gICAgICogb2YgeW91ciBjaGFpbiAodGhlIGxlbmd0aCBvZiB5b3VyIGNoYWluIGFycmF5KS5cbiAgICAgKiBBbHNvIGV2ZXJ5dGltZSB5b3UgY3JlYXRlIGEgQmxvY2tjaGFpbiBjbGFzcyB5b3Ugd2lsbCBuZWVkIHRvIGluaXRpYWxpemVkIHRoZSBjaGFpbiBjcmVhdGluZ1xuICAgICAqIHRoZSBHZW5lc2lzIEJsb2NrLlxuICAgICAqIFRoZSBtZXRob2RzIGluIHRoaXMgY2xhc3Mgd2lsbCBhbHdheXMgcmV0dXJuIGEgUHJvbWlzZSB0byBhbGxvdyBjbGllbnQgYXBwbGljYXRpb25zIG9yXG4gICAgICogb3RoZXIgYmFja2VuZHMgdG8gY2FsbCBhc3luY2hyb25vdXMgZnVuY3Rpb25zLlxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICB0aGlzLmNoYWluID0gW107XG4gICAgICAgIHRoaXMuaGVpZ2h0ID0gLTE7XG4gICAgICAgIHRoaXMuaW5pdGlhbGl6ZUNoYWluKCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVGhpcyBtZXRob2Qgd2lsbCBjaGVjayBmb3IgdGhlIGhlaWdodCBvZiB0aGUgY2hhaW4gYW5kIGlmIHRoZXJlIGlzbid0IGEgR2VuZXNpcyBCbG9jayBpdCB3aWxsIGNyZWF0ZSBpdC5cbiAgICAgKiBZb3Ugc2hvdWxkIHVzZSB0aGUgYGFkZEJsb2NrKGJsb2NrKWAgdG8gY3JlYXRlIHRoZSBHZW5lc2lzIEJsb2NrXG4gICAgICogUGFzc2luZyBhcyBhIGRhdGEgYHtkYXRhOiAnR2VuZXNpcyBCbG9jayd9YFxuICAgICAqL1xuICAgIGFzeW5jIGluaXRpYWxpemVDaGFpbigpIHtcbiAgICAgICAgaWYoIHRoaXMuaGVpZ2h0ID09PSAtMSl7XG4gICAgICAgICAgICBsZXQgYmxvY2sgPSBuZXcgQmxvY2tDbGFzcy5CbG9jayh7ZGF0YTogJ0dlbmVzaXMgQmxvY2snfSk7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLl9hZGRCbG9jayhibG9jayk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBVdGlsaXR5IG1ldGhvZCB0aGF0IHJldHVybiBhIFByb21pc2UgdGhhdCB3aWxsIHJlc29sdmUgd2l0aCB0aGUgaGVpZ2h0IG9mIHRoZSBjaGFpblxuICAgICAqL1xuICAgIGdldENoYWluSGVpZ2h0KCkge1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICAgICAgcmVzb2x2ZSh0aGlzLmhlaWdodCk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIF9hZGRCbG9jayhibG9jaykgd2lsbCBzdG9yZSBhIGJsb2NrIGluIHRoZSBjaGFpblxuICAgICAqIEBwYXJhbSB7Kn0gYmxvY2tcbiAgICAgKiBUaGUgbWV0aG9kIHdpbGwgcmV0dXJuIGEgUHJvbWlzZSB0aGF0IHdpbGwgcmVzb2x2ZSB3aXRoIHRoZSBibG9jayBhZGRlZFxuICAgICAqIG9yIHJlamVjdCBpZiBhbiBlcnJvciBoYXBwZW4gZHVyaW5nIHRoZSBleGVjdXRpb24uXG4gICAgICogWW91IHdpbGwgbmVlZCB0byBjaGVjayBmb3IgdGhlIGhlaWdodCB0byBhc3NpZ24gdGhlIGBwcmV2aW91c0Jsb2NrSGFzaGAsXG4gICAgICogYXNzaWduIHRoZSBgdGltZXN0YW1wYCBhbmQgdGhlIGNvcnJlY3QgYGhlaWdodGAuLi5BdCB0aGUgZW5kIHlvdSBuZWVkIHRvXG4gICAgICogY3JlYXRlIHRoZSBgYmxvY2sgaGFzaGAgYW5kIHB1c2ggdGhlIGJsb2NrIGludG8gdGhlIGNoYWluIGFycmF5LiBEb24ndCBmb3IgZ2V0XG4gICAgICogdG8gdXBkYXRlIHRoZSBgdGhpcy5oZWlnaHRgXG4gICAgICogTm90ZTogdGhlIHN5bWJvbCBgX2AgaW4gdGhlIG1ldGhvZCBuYW1lIGluZGljYXRlcyBpbiB0aGUgamF2YXNjcmlwdCBjb252ZW50aW9uXG4gICAgICogdGhhdCB0aGlzIG1ldGhvZCBpcyBhIHByaXZhdGUgbWV0aG9kLlxuICAgICAqL1xuICAgIF9hZGRCbG9jayhibG9jaykge1xuICAgICAgICBsZXQgc2VsZiA9IHRoaXM7XG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShhc3luYyAocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICAgICAgICBpZiAodGhpcy5jaGFpbi5sZW5ndGg+MCkge1xuICAgICAgICAgICAgICAgIC8vIHByZXZpb3VzIGJsb2NrIGhhc2hcbiAgICAgICAgICAgICAgICBibG9jay5wcmV2aW91c0Jsb2NrSGFzaCA9IHRoaXMuY2hhaW5bdGhpcy5jaGFpbi5sZW5ndGgtMV0uaGFzaDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gYmxvY2sgaGVpZ2h0XG4gICAgICAgICAgICBibG9jay5oZWlnaHQgPSB0aGlzLmNoYWluLmxlbmd0aDtcbiAgICAgICAgICAgIC8vIFVUQyB0aW1lc3RhbXBcbiAgICAgICAgICAgIGJsb2NrLnRpbWUgPSBuZXcgRGF0ZSgpLmdldFRpbWUoKS50b1N0cmluZygpLnNsaWNlKDAsLTMpO1xuICAgICAgICAgICAgLy8gU0hBMjU2IHJlcXVpcmVzIGEgc3RyaW5nIG9mIGRhdGFcbiAgICAgICAgICAgIGJsb2NrLmhhc2ggPSBTSEEyNTYoSlNPTi5zdHJpbmdpZnkoYmxvY2spKS50b1N0cmluZygpO1xuXG4gICAgICAgICAgICBsZXQgdmFsaWRhdGlvbkVycm9ycyA9IGF3YWl0IHNlbGYudmFsaWRhdGVDaGFpbigpO1xuXG4gICAgICAgICAgICBpZiAoYmxvY2suaGFzaCAmJiB2YWxpZGF0aW9uRXJyb3JzLmxlbmd0aCA9PSAwKSB7XG4gICAgICAgICAgICAgICAgLy8gYWRkIGJsb2NrIHRvIGNoYWluXG4gICAgICAgICAgICAgICAgc2VsZi5jaGFpbi5wdXNoKGJsb2NrKTtcbiAgICAgICAgICAgICAgICBzZWxmLmhlaWdodCsrO1xuICAgICAgICAgICAgICAgIHJlc29sdmUoYmxvY2spO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICByZWplY3QoXCJGYWlsZWQgdG8gYWRkIGJsb2NrXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUaGUgcmVxdWVzdE1lc3NhZ2VPd25lcnNoaXBWZXJpZmljYXRpb24oYWRkcmVzcykgbWV0aG9kXG4gICAgICogd2lsbCBhbGxvdyB5b3UgIHRvIHJlcXVlc3QgYSBtZXNzYWdlIHRoYXQgeW91IHdpbGwgdXNlIHRvXG4gICAgICogc2lnbiBpdCB3aXRoIHlvdXIgQml0Y29pbiBXYWxsZXQgKEVsZWN0cnVtIG9yIEJpdGNvaW4gQ29yZSlcbiAgICAgKiBUaGlzIGlzIHRoZSBmaXJzdCBzdGVwIGJlZm9yZSBzdWJtaXQgeW91ciBCbG9jay5cbiAgICAgKiBUaGUgbWV0aG9kIHJldHVybiBhIFByb21pc2UgdGhhdCB3aWxsIHJlc29sdmUgd2l0aCB0aGUgbWVzc2FnZSB0byBiZSBzaWduZWRcbiAgICAgKiBAcGFyYW0geyp9IGFkZHJlc3NcbiAgICAgKi9cbiAgICByZXF1ZXN0TWVzc2FnZU93bmVyc2hpcFZlcmlmaWNhdGlvbihhZGRyZXNzKSB7XG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4ge1xuICAgICAgICAgICAgcmVzb2x2ZShgJHthZGRyZXNzfToke25ldyBEYXRlKCkuZ2V0VGltZSgpLnRvU3RyaW5nKCkuc2xpY2UoMCwtMyl9OnN0YXJSZWdpc3RyeWApO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUaGUgc3VibWl0U3RhcihhZGRyZXNzLCBtZXNzYWdlLCBzaWduYXR1cmUsIHN0YXIpIG1ldGhvZFxuICAgICAqIHdpbGwgYWxsb3cgdXNlcnMgdG8gcmVnaXN0ZXIgYSBuZXcgQmxvY2sgd2l0aCB0aGUgc3RhciBvYmplY3RcbiAgICAgKiBpbnRvIHRoZSBjaGFpbi4gVGhpcyBtZXRob2Qgd2lsbCByZXNvbHZlIHdpdGggdGhlIEJsb2NrIGFkZGVkIG9yXG4gICAgICogcmVqZWN0IHdpdGggYW4gZXJyb3IuXG4gICAgICogQWxnb3JpdGhtIHN0ZXBzOlxuICAgICAqIDEuIEdldCB0aGUgdGltZSBmcm9tIHRoZSBtZXNzYWdlIHNlbnQgYXMgYSBwYXJhbWV0ZXIgZXhhbXBsZTogYHBhcnNlSW50KG1lc3NhZ2Uuc3BsaXQoJzonKVsxXSlgXG4gICAgICogMi4gR2V0IHRoZSBjdXJyZW50IHRpbWU6IGBsZXQgY3VycmVudFRpbWUgPSBwYXJzZUludChuZXcgRGF0ZSgpLmdldFRpbWUoKS50b1N0cmluZygpLnNsaWNlKDAsIC0zKSk7YFxuICAgICAqIDMuIENoZWNrIGlmIHRoZSB0aW1lIGVsYXBzZWQgaXMgbGVzcyB0aGFuIDUgbWludXRlc1xuICAgICAqIDQuIFZlaWZ5IHRoZSBtZXNzYWdlIHdpdGggd2FsbGV0IGFkZHJlc3MgYW5kIHNpZ25hdHVyZTogYGJpdGNvaW5NZXNzYWdlLnZlcmlmeShtZXNzYWdlLCBhZGRyZXNzLCBzaWduYXR1cmUpYFxuICAgICAqIDUuIENyZWF0ZSB0aGUgYmxvY2sgYW5kIGFkZCBpdCB0byB0aGUgY2hhaW5cbiAgICAgKiA2LiBSZXNvbHZlIHdpdGggdGhlIGJsb2NrIGFkZGVkLlxuICAgICAqIEBwYXJhbSB7Kn0gYWRkcmVzc1xuICAgICAqIEBwYXJhbSB7Kn0gbWVzc2FnZVxuICAgICAqIEBwYXJhbSB7Kn0gc2lnbmF0dXJlXG4gICAgICogQHBhcmFtIHsqfSBzdGFyXG4gICAgICovXG4gICAgc3VibWl0U3RhcihhZGRyZXNzLCBtZXNzYWdlLCBzaWduYXR1cmUsIHN0YXIpIHtcbiAgICAgICAgbGV0IHNlbGYgPSB0aGlzO1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoYXN5bmMgKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICAgICAgbGV0IG1lc3NhZ2VUaW1lID0gcGFyc2VJbnQobWVzc2FnZS5zcGxpdCgnOicpWzFdKTtcbiAgICAgICAgICAgIGxldCBjdXJyZW50VGltZSA9IHBhcnNlSW50KG5ldyBEYXRlKCkuZ2V0VGltZSgpLnRvU3RyaW5nKCkuc2xpY2UoMCwgLTMpKTtcblxuICAgICAgICAgICAgdmFyIEZJVkVfTUlOPTUqNjAqMTAwMDtcbiAgICAgICAgICAgIGxldCBkZWFkbGluZSA9IG1lc3NhZ2VUaW1lICsgRklWRV9NSU47XG5cbiAgICAgICAgICAgIGlmIChkZWFkbGluZSA+PSBjdXJyZW50VGltZSkge1xuICAgICAgICAgICAgICAgIGlmIChiaXRjb2luTWVzc2FnZS52ZXJpZnkobWVzc2FnZSwgYWRkcmVzcywgc2lnbmF0dXJlKSkge1xuICAgICAgICAgICAgICAgICAgICBsZXQgYmxvY2sgPSBuZXcgQmxvY2tDbGFzcy5CbG9jayh7b3duZXI6IGFkZHJlc3MsIHN0YXI6IHN0YXJ9KTtcbiAgICAgICAgICAgICAgICAgICAgbGV0IGFkZGVkQmxvY2sgPSBhd2FpdCBzZWxmLl9hZGRCbG9jayhibG9jayk7XG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUoYWRkZWRCbG9jayk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KFwiU2lnbmF0dXJlIGlzIG5vdCB2YWxpZFwiKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcmVqZWN0KFwiVGltZSBoYXMgZWxhcHNlZCBtb3JlIHRoYW4gNSBtaW51dGVzXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUaGlzIG1ldGhvZCB3aWxsIHJldHVybiBhIFByb21pc2UgdGhhdCB3aWxsIHJlc29sdmUgd2l0aCB0aGUgQmxvY2tcbiAgICAgKiAgd2l0aCB0aGUgaGFzaCBwYXNzZWQgYXMgYSBwYXJhbWV0ZXIuXG4gICAgICogU2VhcmNoIG9uIHRoZSBjaGFpbiBhcnJheSBmb3IgdGhlIGJsb2NrIHRoYXQgaGFzIHRoZSBoYXNoLlxuICAgICAqIEBwYXJhbSB7Kn0gaGFzaFxuICAgICAqL1xuICAgIGdldEJsb2NrQnlIYXNoKGhhc2gpIHtcbiAgICAgICAgbGV0IHNlbGYgPSB0aGlzO1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICAgICAgbGV0IGZpbHRlcmVkUmVzdWx0cyA9IHNlbGYuY2hhaW4uYXJyYXkuZmlsdGVyKGJsb2NrID0+IGJsb2NrLmhhc2ggPT0gaGFzaClcblxuICAgICAgICAgICAgaWYgKGZpbHRlcmVkUmVzdWx0cy5sZW5ndGggPT0gMSkge1xuICAgICAgICAgICAgICAgIHJlc29sdmUoZmlsdGVyZWRSZXN1bHRzWzBdKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcmVqZWN0KFwiQmxvY2sgZG9lcyBub3QgZXhpc3RcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRoaXMgbWV0aG9kIHdpbGwgcmV0dXJuIGEgUHJvbWlzZSB0aGF0IHdpbGwgcmVzb2x2ZSB3aXRoIHRoZSBCbG9jayBvYmplY3RcbiAgICAgKiB3aXRoIHRoZSBoZWlnaHQgZXF1YWwgdG8gdGhlIHBhcmFtZXRlciBgaGVpZ2h0YFxuICAgICAqIEBwYXJhbSB7Kn0gaGVpZ2h0XG4gICAgICovXG4gICAgZ2V0QmxvY2tCeUhlaWdodChoZWlnaHQpIHtcbiAgICAgICAgbGV0IHNlbGYgPSB0aGlzO1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICAgICAgbGV0IGJsb2NrID0gc2VsZi5jaGFpbi5maWx0ZXIocCA9PiBwLmhlaWdodCA9PT0gaGVpZ2h0KVswXTtcbiAgICAgICAgICAgIGlmKGJsb2NrKXtcbiAgICAgICAgICAgICAgICByZXNvbHZlKGJsb2NrKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcmVzb2x2ZShudWxsKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVGhpcyBtZXRob2Qgd2lsbCByZXR1cm4gYSBQcm9taXNlIHRoYXQgd2lsbCByZXNvbHZlIHdpdGggYW4gYXJyYXkgb2YgU3RhcnMgb2JqZWN0cyBleGlzdGluZyBpbiB0aGUgY2hhaW5cbiAgICAgKiBhbmQgYXJlIGJlbG9uZ3MgdG8gdGhlIG93bmVyIHdpdGggdGhlIHdhbGxldCBhZGRyZXNzIHBhc3NlZCBhcyBwYXJhbWV0ZXIuXG4gICAgICogUmVtZW1iZXIgdGhlIHN0YXIgc2hvdWxkIGJlIHJldHVybmVkIGRlY29kZWQuXG4gICAgICogQHBhcmFtIHsqfSBhZGRyZXNzXG4gICAgICovXG4gICAgZ2V0U3RhcnNCeVdhbGxldEFkZHJlc3MoYWRkcmVzcykge1xuICAgICAgICBsZXQgc2VsZiA9IHRoaXM7XG4gICAgICAgIGxldCBzdGFycyA9IFtdO1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoYXN5bmMgKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICAgICAgc2VsZi5jaGFpbi5mb3JFYWNoKGFzeW5jIChibG9jaykgPT4ge1xuICAgICAgICAgICAgICAgIGxldCBkYXRhID0gYXdhaXQgYmxvY2suZ2V0QkRhdGEoKTtcbiAgICAgICAgICAgICAgICBpZiAoZGF0YS5vd25lciA9PT0gYWRkcmVzcykgc3RhcnMucHVzaChkYXRhKTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBpZihzdGFycy5sZW5ndGggPT0gMCl7XG4gICAgICAgICAgICAgICAgcmVzb2x2ZShzdGFycyk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJlamVjdChcIlRoZXJlIGlzIHN0YXIgYXNvY2lhdGVkIHdpdGggdGhpcyBhZGRyZXNzICR7YWRkcmVzc31cIik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRoaXMgbWV0aG9kIHdpbGwgcmV0dXJuIGEgUHJvbWlzZSB0aGF0IHdpbGwgcmVzb2x2ZSB3aXRoIHRoZSBsaXN0IG9mIGVycm9ycyB3aGVuIHZhbGlkYXRpbmcgdGhlIGNoYWluLlxuICAgICAqIFN0ZXBzIHRvIHZhbGlkYXRlOlxuICAgICAqIDEuIFlvdSBzaG91bGQgdmFsaWRhdGUgZWFjaCBibG9jayB1c2luZyBgdmFsaWRhdGVCbG9ja2BcbiAgICAgKiAyLiBFYWNoIEJsb2NrIHNob3VsZCBjaGVjayB0aGUgd2l0aCB0aGUgcHJldmlvdXNCbG9ja0hhc2hcbiAgICAgKi9cbiAgICB2YWxpZGF0ZUNoYWluKCkge1xuICAgICAgICBsZXQgc2VsZiA9IHRoaXM7XG4gICAgICAgIGxldCBlcnJvckxvZyA9IFtdO1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoYXN5bmMgKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICAgICAgc2VsZi5jaGFpbi5mb3JFYWNoKChibG9jaykgPT4ge1xuICAgICAgICAgICAgICAgIGxldCBpc1ZhbGlkID0gYmxvY2sudmFsaWRhdGUoKTtcblxuICAgICAgICAgICAgICAgIGlmKCFpc1ZhbGlkKXtcbiAgICAgICAgICAgICAgICAgICAgZXJyb3JMb2cucHVzaChuZXcgRXJyb3IoJ0hhc2ggb2YgcHJldmlvdXMgYmxvY2sgZG8gbm90IG1hdGNoICR7YmxvY2suaGVpZ2h0fScpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgcmVzb2x2ZShlcnJvckxvZyk7XG4gICAgICAgIH0pO1xuICAgIH1cblxufVxuXG5tb2R1bGUuZXhwb3J0cy5CbG9ja2NoYWluID0gQmxvY2tjaGFpbjtcbiJdfQ==",
    "map": {
      "version": 3,
      "sources": [
        "blockchain.js"
      ],
      "names": [
        "SHA256",
        "require",
        "BlockClass",
        "bitcoinMessage",
        "Blockchain",
        "constructor",
        "chain",
        "height",
        "initializeChain",
        "block",
        "Block",
        "data",
        "_addBlock",
        "getChainHeight",
        "Promise",
        "resolve",
        "reject",
        "self",
        "length",
        "previousBlockHash",
        "hash",
        "time",
        "Date",
        "getTime",
        "toString",
        "slice",
        "JSON",
        "stringify",
        "validationErrors",
        "validateChain",
        "push",
        "requestMessageOwnershipVerification",
        "address",
        "submitStar",
        "message",
        "signature",
        "star",
        "messageTime",
        "parseInt",
        "split",
        "currentTime",
        "FIVE_MIN",
        "deadline",
        "verify",
        "owner",
        "addedBlock",
        "getBlockByHash",
        "filteredResults",
        "array",
        "filter",
        "getBlockByHeight",
        "p",
        "getStarsByWalletAddress",
        "stars",
        "forEach",
        "getBData",
        "errorLog",
        "isValid",
        "validate",
        "Error",
        "module",
        "exports"
      ],
      "mappings": "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",
      "sourceRoot": "/Users/stockbit/Downloads/project_1_v2_boilerplate/src/",
      "sourcesContent": [
        "/**\n *                          Blockchain Class\n *  The Blockchain class contain the basics functions to create your own private blockchain\n *  It uses libraries like `crypto-js` to create the hashes for each block and `bitcoinjs-message`\n *  to verify a message signature. The chain is stored in the array\n *  `this.chain = [];`. Of course each time you run the application the chain will be empty because and array\n *  isn't a persisten storage method.\n *\n */\n\nconst SHA256 = require('crypto-js/sha256');\nconst BlockClass = require('./block.js');\nconst bitcoinMessage = require('bitcoinjs-message');\n\nclass Blockchain {\n\n    /**\n     * Constructor of the class, you will need to setup your chain array and the height\n     * of your chain (the length of your chain array).\n     * Also everytime you create a Blockchain class you will need to initialized the chain creating\n     * the Genesis Block.\n     * The methods in this class will always return a Promise to allow client applications or\n     * other backends to call asynchronous functions.\n     */\n    constructor() {\n        this.chain = [];\n        this.height = -1;\n        this.initializeChain();\n    }\n\n    /**\n     * This method will check for the height of the chain and if there isn't a Genesis Block it will create it.\n     * You should use the `addBlock(block)` to create the Genesis Block\n     * Passing as a data `{data: 'Genesis Block'}`\n     */\n    async initializeChain() {\n        if( this.height === -1){\n            let block = new BlockClass.Block({data: 'Genesis Block'});\n            await this._addBlock(block);\n        }\n    }\n\n    /**\n     * Utility method that return a Promise that will resolve with the height of the chain\n     */\n    getChainHeight() {\n        return new Promise((resolve, reject) => {\n            resolve(this.height);\n        });\n    }\n\n    /**\n     * _addBlock(block) will store a block in the chain\n     * @param {*} block\n     * The method will return a Promise that will resolve with the block added\n     * or reject if an error happen during the execution.\n     * You will need to check for the height to assign the `previousBlockHash`,\n     * assign the `timestamp` and the correct `height`...At the end you need to\n     * create the `block hash` and push the block into the chain array. Don't for get\n     * to update the `this.height`\n     * Note: the symbol `_` in the method name indicates in the javascript convention\n     * that this method is a private method.\n     */\n    _addBlock(block) {\n        let self = this;\n        return new Promise(async (resolve, reject) => {\n            if (this.chain.length>0) {\n                // previous block hash\n                block.previousBlockHash = this.chain[this.chain.length-1].hash;\n            }\n\n            // block height\n            block.height = this.chain.length;\n            // UTC timestamp\n            block.time = new Date().getTime().toString().slice(0,-3);\n            // SHA256 requires a string of data\n            block.hash = SHA256(JSON.stringify(block)).toString();\n\n            let validationErrors = await self.validateChain();\n\n            if (block.hash && validationErrors.length == 0) {\n                // add block to chain\n                self.chain.push(block);\n                self.height++;\n                resolve(block);\n            } else {\n                reject(\"Failed to add block\");\n            }\n        });\n    }\n\n    /**\n     * The requestMessageOwnershipVerification(address) method\n     * will allow you  to request a message that you will use to\n     * sign it with your Bitcoin Wallet (Electrum or Bitcoin Core)\n     * This is the first step before submit your Block.\n     * The method return a Promise that will resolve with the message to be signed\n     * @param {*} address\n     */\n    requestMessageOwnershipVerification(address) {\n        return new Promise((resolve) => {\n            resolve(`${address}:${new Date().getTime().toString().slice(0,-3)}:starRegistry`);\n        });\n    }\n\n    /**\n     * The submitStar(address, message, signature, star) method\n     * will allow users to register a new Block with the star object\n     * into the chain. This method will resolve with the Block added or\n     * reject with an error.\n     * Algorithm steps:\n     * 1. Get the time from the message sent as a parameter example: `parseInt(message.split(':')[1])`\n     * 2. Get the current time: `let currentTime = parseInt(new Date().getTime().toString().slice(0, -3));`\n     * 3. Check if the time elapsed is less than 5 minutes\n     * 4. Veify the message with wallet address and signature: `bitcoinMessage.verify(message, address, signature)`\n     * 5. Create the block and add it to the chain\n     * 6. Resolve with the block added.\n     * @param {*} address\n     * @param {*} message\n     * @param {*} signature\n     * @param {*} star\n     */\n    submitStar(address, message, signature, star) {\n        let self = this;\n        return new Promise(async (resolve, reject) => {\n            let messageTime = parseInt(message.split(':')[1]);\n            let currentTime = parseInt(new Date().getTime().toString().slice(0, -3));\n\n            var FIVE_MIN=5*60*1000;\n            let deadline = messageTime + FIVE_MIN;\n\n            if (deadline >= currentTime) {\n                if (bitcoinMessage.verify(message, address, signature)) {\n                    let block = new BlockClass.Block({owner: address, star: star});\n                    let addedBlock = await self._addBlock(block);\n                    resolve(addedBlock);\n                } else {\n                    reject(\"Signature is not valid\");\n                }\n\n            } else {\n                reject(\"Time has elapsed more than 5 minutes\");\n            }\n        });\n    }\n\n    /**\n     * This method will return a Promise that will resolve with the Block\n     *  with the hash passed as a parameter.\n     * Search on the chain array for the block that has the hash.\n     * @param {*} hash\n     */\n    getBlockByHash(hash) {\n        let self = this;\n        return new Promise((resolve, reject) => {\n            let filteredResults = self.chain.array.filter(block => block.hash == hash)\n\n            if (filteredResults.length == 1) {\n                resolve(filteredResults[0]);\n            } else {\n                reject(\"Block does not exist\");\n            }\n        });\n    }\n\n    /**\n     * This method will return a Promise that will resolve with the Block object\n     * with the height equal to the parameter `height`\n     * @param {*} height\n     */\n    getBlockByHeight(height) {\n        let self = this;\n        return new Promise((resolve, reject) => {\n            let block = self.chain.filter(p => p.height === height)[0];\n            if(block){\n                resolve(block);\n            } else {\n                resolve(null);\n            }\n        });\n    }\n\n    /**\n     * This method will return a Promise that will resolve with an array of Stars objects existing in the chain\n     * and are belongs to the owner with the wallet address passed as parameter.\n     * Remember the star should be returned decoded.\n     * @param {*} address\n     */\n    getStarsByWalletAddress(address) {\n        let self = this;\n        let stars = [];\n        return new Promise(async (resolve, reject) => {\n            self.chain.forEach(async (block) => {\n                let data = await block.getBData();\n                if (data.owner === address) stars.push(data);\n            });\n\n            if(stars.length == 0){\n                resolve(stars);\n            } else {\n                reject(\"There is star asociated with this address ${address}\");\n            }\n        });\n    }\n\n    /**\n     * This method will return a Promise that will resolve with the list of errors when validating the chain.\n     * Steps to validate:\n     * 1. You should validate each block using `validateBlock`\n     * 2. Each Block should check the with the previousBlockHash\n     */\n    validateChain() {\n        let self = this;\n        let errorLog = [];\n        return new Promise(async (resolve, reject) => {\n            self.chain.forEach((block) => {\n                let isValid = block.validate();\n\n                if(!isValid){\n                    errorLog.push(new Error('Hash of previous block do not match ${block.height}'));\n                }\n            });\n\n            resolve(errorLog);\n        });\n    }\n\n}\n\nmodule.exports.Blockchain = Blockchain;\n"
      ]
    },
    "sourceType": "script",
    "mtime": 1622013326990
  },
  "{\"assumptions\":{},\"sourceRoot\":\"/Users/stockbit/Downloads/project_1_v2_boilerplate/src/\",\"caller\":{\"name\":\"@babel/node\"},\"configFile\":false,\"cwd\":\"/Users/stockbit/Downloads/project_1_v2_boilerplate\",\"filename\":\"/Users/stockbit/Downloads/project_1_v2_boilerplate/src/block.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"production\",\"root\":\"/Users/stockbit/Downloads/project_1_v2_boilerplate\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":true,\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false}},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false}}],\"presets\":[]}:7.14.3:production": {
    "metadata": {},
    "options": {
      "assumptions": {},
      "sourceRoot": "/Users/stockbit/Downloads/project_1_v2_boilerplate/src/",
      "caller": {
        "name": "@babel/node"
      },
      "configFile": false,
      "cwd": "/Users/stockbit/Downloads/project_1_v2_boilerplate",
      "filename": "/Users/stockbit/Downloads/project_1_v2_boilerplate/src/block.js",
      "targets": {},
      "cloneInputAst": true,
      "babelrc": false,
      "browserslistConfigFile": false,
      "envName": "production",
      "root": "/Users/stockbit/Downloads/project_1_v2_boilerplate",
      "rootMode": "root",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [
        {
          "key": "syntax-class-properties",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-numeric-separator",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-nullish-coalescing-operator",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-optional-chaining",
          "visitor": {
            "_exploded": true,
            "OptionalCallExpression": {
              "enter": [
                null
              ]
            },
            "OptionalMemberExpression": {
              "enter": [
                null
              ]
            },
            "_verified": true
          },
          "options": {
            "spec": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-json-strings",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-optional-catch-binding",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-async-generators",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-object-rest-spread",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-modules-commonjs",
          "visitor": {
            "CallExpression": {
              "enter": [
                null
              ]
            },
            "Program": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-dynamic-import",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "Program": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-export-namespace-from",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "ExportNamedDeclaration": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "useBuiltIns": false
          }
        }
      ],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "/Users/stockbit/Downloads/project_1_v2_boilerplate/src/block.js",
        "plugins": [
          "classProperties",
          "classPrivateProperties",
          "classPrivateMethods",
          "numericSeparator",
          "nullishCoalescingOperator",
          "jsonStrings",
          "optionalCatchBinding",
          "asyncGenerators",
          "objectRestSpread",
          "dynamicImport",
          "exportNamespaceFrom"
        ]
      },
      "generatorOpts": {
        "filename": "/Users/stockbit/Downloads/project_1_v2_boilerplate/src/block.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "/Users/stockbit/Downloads/project_1_v2_boilerplate/src/",
        "sourceFileName": "block.js"
      }
    },
    "ast": null,
    "code": "\"use strict\";\n\n/**\n *                          Block class\n *  The Block class is a main component into any Blockchain platform,\n *  it will store the data and act as a dataset for your application.\n *  The class will expose a method to validate the data... The body of\n *  the block will contain an Object that contain the data to be stored,\n *  the data should be stored encoded.\n *  All the exposed methods should return a Promise to allow all the methods\n *  run asynchronous.\n */\nconst SHA256 = require('crypto-js/sha256');\n\nconst hex2ascii = require('hex2ascii');\n\nclass Block {\n  // Constructor - argument data will be the object containing the transaction data\n  constructor(data) {\n    this.hash = null; // Hash of the block\n\n    this.height = 0; // Block Height (consecutive number of each block)\n\n    this.body = Buffer(JSON.stringify(data)).toString('hex'); // Will contain the transactions stored in the block, by default it will encode the data\n\n    this.time = 0; // Timestamp for the Block creation\n\n    this.previousBlockHash = null; // Reference to the previous Block Hash\n  }\n  /**\n   *  validate() method will validate if the block has been tampered or not.\n   *  Been tampered means that someone from outside the application tried to change\n   *  values in the block data as a consecuence the hash of the block should be different.\n   *  Steps:\n   *  1. Return a new promise to allow the method be called asynchronous.\n   *  2. Save the in auxiliary variable the current hash of the block (`this` represent the block object)\n   *  3. Recalculate the hash of the entire block (Use SHA256 from crypto-js library)\n   *  4. Compare if the auxiliary hash value is different from the calculated one.\n   *  5. Resolve true or false depending if it is valid or not.\n   *  Note: to access the class values inside a Promise code you need to create an auxiliary value `let self = this;`\n   */\n\n\n  validate() {\n    let self = this;\n    return new Promise((resolve, reject) => {\n      try {\n        // Save in auxiliary variable the current block hash\n        let string = JSON.stringify(self);\n        let recalculatedHash = SHA256(string); // Recalculate the hash of the Block\n        // Comparing if the hashes changed\n        // Returning the Block is valid\n        // do a thing, possibly async, then\n\n        resolve(self.hash == recalculatedHash);\n      } catch (error) {\n        reject(new Error(error));\n      }\n    });\n  }\n  /**\n   *  Auxiliary Method to return the block body (decoding the data)\n   *  Steps:\n   *\n   *  1. Use hex2ascii module to decode the data\n   *  2. Because data is a javascript object use JSON.parse(string) to get the Javascript Object\n   *  3. Resolve with the data and make sure that you don't need to return the data for the `genesis block`\n   *     or Reject with an error.\n   */\n\n\n  getBData() {\n    // Getting the encoded data saved in the Block\n    // Decoding the data to retrieve the JSON representation of the object\n    // Parse the data to an object to be retrieve.\n    // Resolve with the data if the object isn't the Genesis block\n    let self = this;\n    return new Promise((resolve, reject) => {\n      try {\n        let decodedData = hex2ascii(self.body);\n        let parsedData = JSON.parse(decodedData);\n\n        if (self.height > 0) {\n          resolve(parsedData);\n        } else {\n          reject(\"Cannot retrieve genesis block\");\n        }\n      } catch (error) {\n        reject(new Error(error));\n      }\n    });\n  }\n\n}\n\nmodule.exports.Block = Block; // Exposing the Block class as a module\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImJsb2NrLmpzIl0sIm5hbWVzIjpbIlNIQTI1NiIsInJlcXVpcmUiLCJoZXgyYXNjaWkiLCJCbG9jayIsImNvbnN0cnVjdG9yIiwiZGF0YSIsImhhc2giLCJoZWlnaHQiLCJib2R5IiwiQnVmZmVyIiwiSlNPTiIsInN0cmluZ2lmeSIsInRvU3RyaW5nIiwidGltZSIsInByZXZpb3VzQmxvY2tIYXNoIiwidmFsaWRhdGUiLCJzZWxmIiwiUHJvbWlzZSIsInJlc29sdmUiLCJyZWplY3QiLCJzdHJpbmciLCJyZWNhbGN1bGF0ZWRIYXNoIiwiZXJyb3IiLCJFcnJvciIsImdldEJEYXRhIiwiZGVjb2RlZERhdGEiLCJwYXJzZWREYXRhIiwicGFyc2UiLCJtb2R1bGUiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiOztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUEsTUFBTUEsTUFBTSxHQUFHQyxPQUFPLENBQUMsa0JBQUQsQ0FBdEI7O0FBQ0EsTUFBTUMsU0FBUyxHQUFHRCxPQUFPLENBQUMsV0FBRCxDQUF6Qjs7QUFFQSxNQUFNRSxLQUFOLENBQVk7QUFFUjtBQUNIQyxFQUFBQSxXQUFXLENBQUNDLElBQUQsRUFBTTtBQUNoQixTQUFLQyxJQUFMLEdBQVksSUFBWixDQURnQixDQUM0Qzs7QUFDNUQsU0FBS0MsTUFBTCxHQUFjLENBQWQsQ0FGZ0IsQ0FFNEM7O0FBQzVELFNBQUtDLElBQUwsR0FBWUMsTUFBTSxDQUFDQyxJQUFJLENBQUNDLFNBQUwsQ0FBZU4sSUFBZixDQUFELENBQU4sQ0FBNkJPLFFBQTdCLENBQXNDLEtBQXRDLENBQVosQ0FIZ0IsQ0FHNEM7O0FBQzVELFNBQUtDLElBQUwsR0FBWSxDQUFaLENBSmdCLENBSTRDOztBQUM1RCxTQUFLQyxpQkFBTCxHQUF5QixJQUF6QixDQUxnQixDQUs0QztBQUN6RDtBQUVEO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBQ0lDLEVBQUFBLFFBQVEsR0FBRztBQUNQLFFBQUlDLElBQUksR0FBRyxJQUFYO0FBQ0EsV0FBTyxJQUFJQyxPQUFKLENBQVksQ0FBQ0MsT0FBRCxFQUFVQyxNQUFWLEtBQXFCO0FBQ3BDLFVBQUk7QUFDQTtBQUNBLFlBQUlDLE1BQU0sR0FBR1YsSUFBSSxDQUFDQyxTQUFMLENBQWVLLElBQWYsQ0FBYjtBQUNBLFlBQUlLLGdCQUFnQixHQUFHckIsTUFBTSxDQUFDb0IsTUFBRCxDQUE3QixDQUhBLENBS0E7QUFDQTtBQUNBO0FBQ0E7O0FBQ0FGLFFBQUFBLE9BQU8sQ0FBQ0YsSUFBSSxDQUFDVixJQUFMLElBQWFlLGdCQUFkLENBQVA7QUFFSCxPQVhELENBV0UsT0FBT0MsS0FBUCxFQUFjO0FBQ1pILFFBQUFBLE1BQU0sQ0FBQyxJQUFJSSxLQUFKLENBQVVELEtBQVYsQ0FBRCxDQUFOO0FBQ0g7QUFDSixLQWZNLENBQVA7QUFnQkg7QUFFRDtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUNJRSxFQUFBQSxRQUFRLEdBQUc7QUFDUDtBQUNBO0FBQ0E7QUFFQTtBQUNBLFFBQUlSLElBQUksR0FBRyxJQUFYO0FBQ0EsV0FBTyxJQUFJQyxPQUFKLENBQVksQ0FBQ0MsT0FBRCxFQUFVQyxNQUFWLEtBQXFCO0FBQ3BDLFVBQUk7QUFDQSxZQUFJTSxXQUFXLEdBQUd2QixTQUFTLENBQUNjLElBQUksQ0FBQ1IsSUFBTixDQUEzQjtBQUNBLFlBQUlrQixVQUFVLEdBQUdoQixJQUFJLENBQUNpQixLQUFMLENBQVdGLFdBQVgsQ0FBakI7O0FBRUEsWUFBSVQsSUFBSSxDQUFDVCxNQUFMLEdBQWMsQ0FBbEIsRUFBcUI7QUFDakJXLFVBQUFBLE9BQU8sQ0FBQ1EsVUFBRCxDQUFQO0FBQ0gsU0FGRCxNQUVPO0FBQ0hQLFVBQUFBLE1BQU0sQ0FBQywrQkFBRCxDQUFOO0FBQ0g7QUFFSixPQVZELENBVUUsT0FBT0csS0FBUCxFQUFjO0FBQ1pILFFBQUFBLE1BQU0sQ0FBQyxJQUFJSSxLQUFKLENBQVVELEtBQVYsQ0FBRCxDQUFOO0FBQ0g7QUFFSixLQWZNLENBQVA7QUFnQkg7O0FBM0VPOztBQStFWk0sTUFBTSxDQUFDQyxPQUFQLENBQWUxQixLQUFmLEdBQXVCQSxLQUF2QixDLENBQWlEIiwic291cmNlUm9vdCI6Ii9Vc2Vycy9zdG9ja2JpdC9Eb3dubG9hZHMvcHJvamVjdF8xX3YyX2JvaWxlcnBsYXRlL3NyYy8iLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqICAgICAgICAgICAgICAgICAgICAgICAgICBCbG9jayBjbGFzc1xuICogIFRoZSBCbG9jayBjbGFzcyBpcyBhIG1haW4gY29tcG9uZW50IGludG8gYW55IEJsb2NrY2hhaW4gcGxhdGZvcm0sXG4gKiAgaXQgd2lsbCBzdG9yZSB0aGUgZGF0YSBhbmQgYWN0IGFzIGEgZGF0YXNldCBmb3IgeW91ciBhcHBsaWNhdGlvbi5cbiAqICBUaGUgY2xhc3Mgd2lsbCBleHBvc2UgYSBtZXRob2QgdG8gdmFsaWRhdGUgdGhlIGRhdGEuLi4gVGhlIGJvZHkgb2ZcbiAqICB0aGUgYmxvY2sgd2lsbCBjb250YWluIGFuIE9iamVjdCB0aGF0IGNvbnRhaW4gdGhlIGRhdGEgdG8gYmUgc3RvcmVkLFxuICogIHRoZSBkYXRhIHNob3VsZCBiZSBzdG9yZWQgZW5jb2RlZC5cbiAqICBBbGwgdGhlIGV4cG9zZWQgbWV0aG9kcyBzaG91bGQgcmV0dXJuIGEgUHJvbWlzZSB0byBhbGxvdyBhbGwgdGhlIG1ldGhvZHNcbiAqICBydW4gYXN5bmNocm9ub3VzLlxuICovXG5cbmNvbnN0IFNIQTI1NiA9IHJlcXVpcmUoJ2NyeXB0by1qcy9zaGEyNTYnKTtcbmNvbnN0IGhleDJhc2NpaSA9IHJlcXVpcmUoJ2hleDJhc2NpaScpO1xuXG5jbGFzcyBCbG9jayB7XG5cbiAgICAvLyBDb25zdHJ1Y3RvciAtIGFyZ3VtZW50IGRhdGEgd2lsbCBiZSB0aGUgb2JqZWN0IGNvbnRhaW5pbmcgdGhlIHRyYW5zYWN0aW9uIGRhdGFcblx0Y29uc3RydWN0b3IoZGF0YSl7XG5cdFx0dGhpcy5oYXNoID0gbnVsbDsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gSGFzaCBvZiB0aGUgYmxvY2tcblx0XHR0aGlzLmhlaWdodCA9IDA7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBCbG9jayBIZWlnaHQgKGNvbnNlY3V0aXZlIG51bWJlciBvZiBlYWNoIGJsb2NrKVxuXHRcdHRoaXMuYm9keSA9IEJ1ZmZlcihKU09OLnN0cmluZ2lmeShkYXRhKSkudG9TdHJpbmcoJ2hleCcpOyAgIC8vIFdpbGwgY29udGFpbiB0aGUgdHJhbnNhY3Rpb25zIHN0b3JlZCBpbiB0aGUgYmxvY2ssIGJ5IGRlZmF1bHQgaXQgd2lsbCBlbmNvZGUgdGhlIGRhdGFcblx0XHR0aGlzLnRpbWUgPSAwOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBUaW1lc3RhbXAgZm9yIHRoZSBCbG9jayBjcmVhdGlvblxuXHRcdHRoaXMucHJldmlvdXNCbG9ja0hhc2ggPSBudWxsOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFJlZmVyZW5jZSB0byB0aGUgcHJldmlvdXMgQmxvY2sgSGFzaFxuICAgIH1cblxuICAgIC8qKlxuICAgICAqICB2YWxpZGF0ZSgpIG1ldGhvZCB3aWxsIHZhbGlkYXRlIGlmIHRoZSBibG9jayBoYXMgYmVlbiB0YW1wZXJlZCBvciBub3QuXG4gICAgICogIEJlZW4gdGFtcGVyZWQgbWVhbnMgdGhhdCBzb21lb25lIGZyb20gb3V0c2lkZSB0aGUgYXBwbGljYXRpb24gdHJpZWQgdG8gY2hhbmdlXG4gICAgICogIHZhbHVlcyBpbiB0aGUgYmxvY2sgZGF0YSBhcyBhIGNvbnNlY3VlbmNlIHRoZSBoYXNoIG9mIHRoZSBibG9jayBzaG91bGQgYmUgZGlmZmVyZW50LlxuICAgICAqICBTdGVwczpcbiAgICAgKiAgMS4gUmV0dXJuIGEgbmV3IHByb21pc2UgdG8gYWxsb3cgdGhlIG1ldGhvZCBiZSBjYWxsZWQgYXN5bmNocm9ub3VzLlxuICAgICAqICAyLiBTYXZlIHRoZSBpbiBhdXhpbGlhcnkgdmFyaWFibGUgdGhlIGN1cnJlbnQgaGFzaCBvZiB0aGUgYmxvY2sgKGB0aGlzYCByZXByZXNlbnQgdGhlIGJsb2NrIG9iamVjdClcbiAgICAgKiAgMy4gUmVjYWxjdWxhdGUgdGhlIGhhc2ggb2YgdGhlIGVudGlyZSBibG9jayAoVXNlIFNIQTI1NiBmcm9tIGNyeXB0by1qcyBsaWJyYXJ5KVxuICAgICAqICA0LiBDb21wYXJlIGlmIHRoZSBhdXhpbGlhcnkgaGFzaCB2YWx1ZSBpcyBkaWZmZXJlbnQgZnJvbSB0aGUgY2FsY3VsYXRlZCBvbmUuXG4gICAgICogIDUuIFJlc29sdmUgdHJ1ZSBvciBmYWxzZSBkZXBlbmRpbmcgaWYgaXQgaXMgdmFsaWQgb3Igbm90LlxuICAgICAqICBOb3RlOiB0byBhY2Nlc3MgdGhlIGNsYXNzIHZhbHVlcyBpbnNpZGUgYSBQcm9taXNlIGNvZGUgeW91IG5lZWQgdG8gY3JlYXRlIGFuIGF1eGlsaWFyeSB2YWx1ZSBgbGV0IHNlbGYgPSB0aGlzO2BcbiAgICAgKi9cbiAgICB2YWxpZGF0ZSgpIHtcbiAgICAgICAgbGV0IHNlbGYgPSB0aGlzO1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAvLyBTYXZlIGluIGF1eGlsaWFyeSB2YXJpYWJsZSB0aGUgY3VycmVudCBibG9jayBoYXNoXG4gICAgICAgICAgICAgICAgbGV0IHN0cmluZyA9IEpTT04uc3RyaW5naWZ5KHNlbGYpXG4gICAgICAgICAgICAgICAgbGV0IHJlY2FsY3VsYXRlZEhhc2ggPSBTSEEyNTYoc3RyaW5nKVxuXG4gICAgICAgICAgICAgICAgLy8gUmVjYWxjdWxhdGUgdGhlIGhhc2ggb2YgdGhlIEJsb2NrXG4gICAgICAgICAgICAgICAgLy8gQ29tcGFyaW5nIGlmIHRoZSBoYXNoZXMgY2hhbmdlZFxuICAgICAgICAgICAgICAgIC8vIFJldHVybmluZyB0aGUgQmxvY2sgaXMgdmFsaWRcbiAgICAgICAgICAgICAgICAvLyBkbyBhIHRoaW5nLCBwb3NzaWJseSBhc3luYywgdGhlbuKAplxuICAgICAgICAgICAgICAgIHJlc29sdmUoc2VsZi5oYXNoID09IHJlY2FsY3VsYXRlZEhhc2gpO1xuXG4gICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgIHJlamVjdChuZXcgRXJyb3IoZXJyb3IpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogIEF1eGlsaWFyeSBNZXRob2QgdG8gcmV0dXJuIHRoZSBibG9jayBib2R5IChkZWNvZGluZyB0aGUgZGF0YSlcbiAgICAgKiAgU3RlcHM6XG4gICAgICpcbiAgICAgKiAgMS4gVXNlIGhleDJhc2NpaSBtb2R1bGUgdG8gZGVjb2RlIHRoZSBkYXRhXG4gICAgICogIDIuIEJlY2F1c2UgZGF0YSBpcyBhIGphdmFzY3JpcHQgb2JqZWN0IHVzZSBKU09OLnBhcnNlKHN0cmluZykgdG8gZ2V0IHRoZSBKYXZhc2NyaXB0IE9iamVjdFxuICAgICAqICAzLiBSZXNvbHZlIHdpdGggdGhlIGRhdGEgYW5kIG1ha2Ugc3VyZSB0aGF0IHlvdSBkb24ndCBuZWVkIHRvIHJldHVybiB0aGUgZGF0YSBmb3IgdGhlIGBnZW5lc2lzIGJsb2NrYFxuICAgICAqICAgICBvciBSZWplY3Qgd2l0aCBhbiBlcnJvci5cbiAgICAgKi9cbiAgICBnZXRCRGF0YSgpIHtcbiAgICAgICAgLy8gR2V0dGluZyB0aGUgZW5jb2RlZCBkYXRhIHNhdmVkIGluIHRoZSBCbG9ja1xuICAgICAgICAvLyBEZWNvZGluZyB0aGUgZGF0YSB0byByZXRyaWV2ZSB0aGUgSlNPTiByZXByZXNlbnRhdGlvbiBvZiB0aGUgb2JqZWN0XG4gICAgICAgIC8vIFBhcnNlIHRoZSBkYXRhIHRvIGFuIG9iamVjdCB0byBiZSByZXRyaWV2ZS5cblxuICAgICAgICAvLyBSZXNvbHZlIHdpdGggdGhlIGRhdGEgaWYgdGhlIG9iamVjdCBpc24ndCB0aGUgR2VuZXNpcyBibG9ja1xuICAgICAgICBsZXQgc2VsZiA9IHRoaXM7XG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGxldCBkZWNvZGVkRGF0YSA9IGhleDJhc2NpaShzZWxmLmJvZHkpO1xuICAgICAgICAgICAgICAgIGxldCBwYXJzZWREYXRhID0gSlNPTi5wYXJzZShkZWNvZGVkRGF0YSk7XG5cbiAgICAgICAgICAgICAgICBpZiAoc2VsZi5oZWlnaHQgPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUocGFyc2VkRGF0YSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KFwiQ2Fubm90IHJldHJpZXZlIGdlbmVzaXMgYmxvY2tcIik7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgIHJlamVjdChuZXcgRXJyb3IoZXJyb3IpKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICB9KTtcbiAgICB9XG5cbn1cblxubW9kdWxlLmV4cG9ydHMuQmxvY2sgPSBCbG9jazsgICAgICAgICAgICAgICAgICAgIC8vIEV4cG9zaW5nIHRoZSBCbG9jayBjbGFzcyBhcyBhIG1vZHVsZVxuIl19",
    "map": {
      "version": 3,
      "sources": [
        "block.js"
      ],
      "names": [
        "SHA256",
        "require",
        "hex2ascii",
        "Block",
        "constructor",
        "data",
        "hash",
        "height",
        "body",
        "Buffer",
        "JSON",
        "stringify",
        "toString",
        "time",
        "previousBlockHash",
        "validate",
        "self",
        "Promise",
        "resolve",
        "reject",
        "string",
        "recalculatedHash",
        "error",
        "Error",
        "getBData",
        "decodedData",
        "parsedData",
        "parse",
        "module",
        "exports"
      ],
      "mappings": ";;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA,MAAMA,MAAM,GAAGC,OAAO,CAAC,kBAAD,CAAtB;;AACA,MAAMC,SAAS,GAAGD,OAAO,CAAC,WAAD,CAAzB;;AAEA,MAAME,KAAN,CAAY;AAER;AACHC,EAAAA,WAAW,CAACC,IAAD,EAAM;AAChB,SAAKC,IAAL,GAAY,IAAZ,CADgB,CAC4C;;AAC5D,SAAKC,MAAL,GAAc,CAAd,CAFgB,CAE4C;;AAC5D,SAAKC,IAAL,GAAYC,MAAM,CAACC,IAAI,CAACC,SAAL,CAAeN,IAAf,CAAD,CAAN,CAA6BO,QAA7B,CAAsC,KAAtC,CAAZ,CAHgB,CAG4C;;AAC5D,SAAKC,IAAL,GAAY,CAAZ,CAJgB,CAI4C;;AAC5D,SAAKC,iBAAL,GAAyB,IAAzB,CALgB,CAK4C;AACzD;AAED;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AACIC,EAAAA,QAAQ,GAAG;AACP,QAAIC,IAAI,GAAG,IAAX;AACA,WAAO,IAAIC,OAAJ,CAAY,CAACC,OAAD,EAAUC,MAAV,KAAqB;AACpC,UAAI;AACA;AACA,YAAIC,MAAM,GAAGV,IAAI,CAACC,SAAL,CAAeK,IAAf,CAAb;AACA,YAAIK,gBAAgB,GAAGrB,MAAM,CAACoB,MAAD,CAA7B,CAHA,CAKA;AACA;AACA;AACA;;AACAF,QAAAA,OAAO,CAACF,IAAI,CAACV,IAAL,IAAae,gBAAd,CAAP;AAEH,OAXD,CAWE,OAAOC,KAAP,EAAc;AACZH,QAAAA,MAAM,CAAC,IAAII,KAAJ,CAAUD,KAAV,CAAD,CAAN;AACH;AACJ,KAfM,CAAP;AAgBH;AAED;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AACIE,EAAAA,QAAQ,GAAG;AACP;AACA;AACA;AAEA;AACA,QAAIR,IAAI,GAAG,IAAX;AACA,WAAO,IAAIC,OAAJ,CAAY,CAACC,OAAD,EAAUC,MAAV,KAAqB;AACpC,UAAI;AACA,YAAIM,WAAW,GAAGvB,SAAS,CAACc,IAAI,CAACR,IAAN,CAA3B;AACA,YAAIkB,UAAU,GAAGhB,IAAI,CAACiB,KAAL,CAAWF,WAAX,CAAjB;;AAEA,YAAIT,IAAI,CAACT,MAAL,GAAc,CAAlB,EAAqB;AACjBW,UAAAA,OAAO,CAACQ,UAAD,CAAP;AACH,SAFD,MAEO;AACHP,UAAAA,MAAM,CAAC,+BAAD,CAAN;AACH;AAEJ,OAVD,CAUE,OAAOG,KAAP,EAAc;AACZH,QAAAA,MAAM,CAAC,IAAII,KAAJ,CAAUD,KAAV,CAAD,CAAN;AACH;AAEJ,KAfM,CAAP;AAgBH;;AA3EO;;AA+EZM,MAAM,CAACC,OAAP,CAAe1B,KAAf,GAAuBA,KAAvB,C,CAAiD",
      "sourceRoot": "/Users/stockbit/Downloads/project_1_v2_boilerplate/src/",
      "sourcesContent": [
        "/**\n *                          Block class\n *  The Block class is a main component into any Blockchain platform,\n *  it will store the data and act as a dataset for your application.\n *  The class will expose a method to validate the data... The body of\n *  the block will contain an Object that contain the data to be stored,\n *  the data should be stored encoded.\n *  All the exposed methods should return a Promise to allow all the methods\n *  run asynchronous.\n */\n\nconst SHA256 = require('crypto-js/sha256');\nconst hex2ascii = require('hex2ascii');\n\nclass Block {\n\n    // Constructor - argument data will be the object containing the transaction data\n\tconstructor(data){\n\t\tthis.hash = null;                                           // Hash of the block\n\t\tthis.height = 0;                                            // Block Height (consecutive number of each block)\n\t\tthis.body = Buffer(JSON.stringify(data)).toString('hex');   // Will contain the transactions stored in the block, by default it will encode the data\n\t\tthis.time = 0;                                              // Timestamp for the Block creation\n\t\tthis.previousBlockHash = null;                              // Reference to the previous Block Hash\n    }\n\n    /**\n     *  validate() method will validate if the block has been tampered or not.\n     *  Been tampered means that someone from outside the application tried to change\n     *  values in the block data as a consecuence the hash of the block should be different.\n     *  Steps:\n     *  1. Return a new promise to allow the method be called asynchronous.\n     *  2. Save the in auxiliary variable the current hash of the block (`this` represent the block object)\n     *  3. Recalculate the hash of the entire block (Use SHA256 from crypto-js library)\n     *  4. Compare if the auxiliary hash value is different from the calculated one.\n     *  5. Resolve true or false depending if it is valid or not.\n     *  Note: to access the class values inside a Promise code you need to create an auxiliary value `let self = this;`\n     */\n    validate() {\n        let self = this;\n        return new Promise((resolve, reject) => {\n            try {\n                // Save in auxiliary variable the current block hash\n                let string = JSON.stringify(self)\n                let recalculatedHash = SHA256(string)\n\n                // Recalculate the hash of the Block\n                // Comparing if the hashes changed\n                // Returning the Block is valid\n                // do a thing, possibly async, then\n                resolve(self.hash == recalculatedHash);\n\n            } catch (error) {\n                reject(new Error(error));\n            }\n        });\n    }\n\n    /**\n     *  Auxiliary Method to return the block body (decoding the data)\n     *  Steps:\n     *\n     *  1. Use hex2ascii module to decode the data\n     *  2. Because data is a javascript object use JSON.parse(string) to get the Javascript Object\n     *  3. Resolve with the data and make sure that you don't need to return the data for the `genesis block`\n     *     or Reject with an error.\n     */\n    getBData() {\n        // Getting the encoded data saved in the Block\n        // Decoding the data to retrieve the JSON representation of the object\n        // Parse the data to an object to be retrieve.\n\n        // Resolve with the data if the object isn't the Genesis block\n        let self = this;\n        return new Promise((resolve, reject) => {\n            try {\n                let decodedData = hex2ascii(self.body);\n                let parsedData = JSON.parse(decodedData);\n\n                if (self.height > 0) {\n                    resolve(parsedData);\n                } else {\n                    reject(\"Cannot retrieve genesis block\");\n                }\n\n            } catch (error) {\n                reject(new Error(error));\n            }\n\n        });\n    }\n\n}\n\nmodule.exports.Block = Block;                    // Exposing the Block class as a module\n"
      ]
    },
    "sourceType": "script",
    "mtime": 1622013286008
  },
  "{\"assumptions\":{},\"sourceRoot\":\"/Users/stockbit/Downloads/project_1_v2_boilerplate/src/\",\"caller\":{\"name\":\"@babel/node\"},\"configFile\":false,\"cwd\":\"/Users/stockbit/Downloads/project_1_v2_boilerplate\",\"filename\":\"/Users/stockbit/Downloads/project_1_v2_boilerplate/src/block.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"production\",\"root\":\"/Users/stockbit/Downloads/project_1_v2_boilerplate\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":true,\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false}},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false}}],\"presets\":[]}:7.14.3:production": {
    "metadata": {},
    "options": {
      "assumptions": {},
      "sourceRoot": "/Users/stockbit/Downloads/project_1_v2_boilerplate/src/",
      "caller": {
        "name": "@babel/node"
      },
      "configFile": false,
      "cwd": "/Users/stockbit/Downloads/project_1_v2_boilerplate",
      "filename": "/Users/stockbit/Downloads/project_1_v2_boilerplate/src/block.js",
      "targets": {},
      "cloneInputAst": true,
      "babelrc": false,
      "browserslistConfigFile": false,
      "envName": "production",
      "root": "/Users/stockbit/Downloads/project_1_v2_boilerplate",
      "rootMode": "root",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [
        {
          "key": "syntax-class-properties",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-numeric-separator",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-nullish-coalescing-operator",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-optional-chaining",
          "visitor": {
            "_exploded": true,
            "OptionalCallExpression": {
              "enter": [
                null
              ]
            },
            "OptionalMemberExpression": {
              "enter": [
                null
              ]
            },
            "_verified": true
          },
          "options": {
            "spec": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-json-strings",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-optional-catch-binding",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-async-generators",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-object-rest-spread",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-modules-commonjs",
          "visitor": {
            "CallExpression": {
              "enter": [
                null
              ]
            },
            "Program": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-dynamic-import",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "Program": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-export-namespace-from",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "ExportNamedDeclaration": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "useBuiltIns": false
          }
        }
      ],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "/Users/stockbit/Downloads/project_1_v2_boilerplate/src/block.js",
        "plugins": [
          "classProperties",
          "classPrivateProperties",
          "classPrivateMethods",
          "numericSeparator",
          "nullishCoalescingOperator",
          "jsonStrings",
          "optionalCatchBinding",
          "asyncGenerators",
          "objectRestSpread",
          "dynamicImport",
          "exportNamespaceFrom"
        ]
      },
      "generatorOpts": {
        "filename": "/Users/stockbit/Downloads/project_1_v2_boilerplate/src/block.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "/Users/stockbit/Downloads/project_1_v2_boilerplate/src/",
        "sourceFileName": "block.js"
      }
    },
    "ast": null,
    "code": "\"use strict\";\n\n/**\n *                          Block class\n *  The Block class is a main component into any Blockchain platform,\n *  it will store the data and act as a dataset for your application.\n *  The class will expose a method to validate the data... The body of\n *  the block will contain an Object that contain the data to be stored,\n *  the data should be stored encoded.\n *  All the exposed methods should return a Promise to allow all the methods\n *  run asynchronous.\n */\nconst SHA256 = require('crypto-js/sha256');\n\nconst hex2ascii = require('hex2ascii');\n\nclass Block {\n  // Constructor - argument data will be the object containing the transaction data\n  constructor(data) {\n    this.hash = null; // Hash of the block\n\n    this.height = 0; // Block Height (consecutive number of each block)\n\n    this.body = Buffer(JSON.stringify(data)).toString('hex'); // Will contain the transactions stored in the block, by default it will encode the data\n\n    this.time = 0; // Timestamp for the Block creation\n\n    this.previousBlockHash = null; // Reference to the previous Block Hash\n  }\n  /**\n   *  validate() method will validate if the block has been tampered or not.\n   *  Been tampered means that someone from outside the application tried to change\n   *  values in the block data as a consecuence the hash of the block should be different.\n   *  Steps:\n   *  1. Return a new promise to allow the method be called asynchronous.\n   *  2. Save the in auxiliary variable the current hash of the block (`this` represent the block object)\n   *  3. Recalculate the hash of the entire block (Use SHA256 from crypto-js library)\n   *  4. Compare if the auxiliary hash value is different from the calculated one.\n   *  5. Resolve true or false depending if it is valid or not.\n   *  Note: to access the class values inside a Promise code you need to create an auxiliary value `let self = this;`\n   */\n\n\n  validate() {\n    let self = this;\n    return new Promise((resolve, reject) => {\n      try {\n        // Save in auxiliary variable the current block hash\n        let string = JSON.stringify(self);\n        let recalculatedHash = SHA256(string); // Recalculate the hash of the Block\n        // Comparing if the hashes changed\n        // Returning the Block is valid\n        // do a thing, possibly async, then\n\n        resolve(self.hash == recalculatedHash);\n      } catch (error) {\n        reject(new Error(error));\n      }\n    });\n  }\n  /**\n   *  Auxiliary Method to return the block body (decoding the data)\n   *  Steps:\n   *\n   *  1. Use hex2ascii module to decode the data\n   *  2. Because data is a javascript object use JSON.parse(string) to get the Javascript Object\n   *  3. Resolve with the data and make sure that you don't need to return the data for the `genesis block`\n   *     or Reject with an error.\n   */\n\n\n  getBData() {\n    // Getting the encoded data saved in the Block\n    // Decoding the data to retrieve the JSON representation of the object\n    // Parse the data to an object to be retrieve.\n    // Resolve with the data if the object isn't the Genesis block\n    let self = this;\n    return new Promise(async (resolve, reject) => {\n      try {\n        let decodedData = hex2ascii(self.body);\n        let parsedData = JSON.parse(decodedData);\n\n        if (self.height > 0) {\n          resolve(parsedData);\n        } else {\n          reject(\"Cannot retrieve genesis block\");\n        }\n      } catch (error) {\n        reject(new Error(error));\n      }\n    });\n  }\n\n}\n\nmodule.exports.Block = Block; // Exposing the Block class as a module\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImJsb2NrLmpzIl0sIm5hbWVzIjpbIlNIQTI1NiIsInJlcXVpcmUiLCJoZXgyYXNjaWkiLCJCbG9jayIsImNvbnN0cnVjdG9yIiwiZGF0YSIsImhhc2giLCJoZWlnaHQiLCJib2R5IiwiQnVmZmVyIiwiSlNPTiIsInN0cmluZ2lmeSIsInRvU3RyaW5nIiwidGltZSIsInByZXZpb3VzQmxvY2tIYXNoIiwidmFsaWRhdGUiLCJzZWxmIiwiUHJvbWlzZSIsInJlc29sdmUiLCJyZWplY3QiLCJzdHJpbmciLCJyZWNhbGN1bGF0ZWRIYXNoIiwiZXJyb3IiLCJFcnJvciIsImdldEJEYXRhIiwiZGVjb2RlZERhdGEiLCJwYXJzZWREYXRhIiwicGFyc2UiLCJtb2R1bGUiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiOztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUEsTUFBTUEsTUFBTSxHQUFHQyxPQUFPLENBQUMsa0JBQUQsQ0FBdEI7O0FBQ0EsTUFBTUMsU0FBUyxHQUFHRCxPQUFPLENBQUMsV0FBRCxDQUF6Qjs7QUFFQSxNQUFNRSxLQUFOLENBQVk7QUFFUjtBQUNIQyxFQUFBQSxXQUFXLENBQUNDLElBQUQsRUFBTTtBQUNoQixTQUFLQyxJQUFMLEdBQVksSUFBWixDQURnQixDQUM0Qzs7QUFDNUQsU0FBS0MsTUFBTCxHQUFjLENBQWQsQ0FGZ0IsQ0FFNEM7O0FBQzVELFNBQUtDLElBQUwsR0FBWUMsTUFBTSxDQUFDQyxJQUFJLENBQUNDLFNBQUwsQ0FBZU4sSUFBZixDQUFELENBQU4sQ0FBNkJPLFFBQTdCLENBQXNDLEtBQXRDLENBQVosQ0FIZ0IsQ0FHNEM7O0FBQzVELFNBQUtDLElBQUwsR0FBWSxDQUFaLENBSmdCLENBSTRDOztBQUM1RCxTQUFLQyxpQkFBTCxHQUF5QixJQUF6QixDQUxnQixDQUs0QztBQUN6RDtBQUVEO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBQ0lDLEVBQUFBLFFBQVEsR0FBRztBQUNQLFFBQUlDLElBQUksR0FBRyxJQUFYO0FBQ0EsV0FBTyxJQUFJQyxPQUFKLENBQVksQ0FBQ0MsT0FBRCxFQUFVQyxNQUFWLEtBQXFCO0FBQ3BDLFVBQUk7QUFDQTtBQUNBLFlBQUlDLE1BQU0sR0FBR1YsSUFBSSxDQUFDQyxTQUFMLENBQWVLLElBQWYsQ0FBYjtBQUNBLFlBQUlLLGdCQUFnQixHQUFHckIsTUFBTSxDQUFDb0IsTUFBRCxDQUE3QixDQUhBLENBS0E7QUFDQTtBQUNBO0FBQ0E7O0FBQ0FGLFFBQUFBLE9BQU8sQ0FBQ0YsSUFBSSxDQUFDVixJQUFMLElBQWFlLGdCQUFkLENBQVA7QUFFSCxPQVhELENBV0UsT0FBT0MsS0FBUCxFQUFjO0FBQ1pILFFBQUFBLE1BQU0sQ0FBQyxJQUFJSSxLQUFKLENBQVVELEtBQVYsQ0FBRCxDQUFOO0FBQ0g7QUFDSixLQWZNLENBQVA7QUFnQkg7QUFFRDtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUNJRSxFQUFBQSxRQUFRLEdBQUc7QUFDUDtBQUNBO0FBQ0E7QUFFQTtBQUNBLFFBQUlSLElBQUksR0FBRyxJQUFYO0FBQ0EsV0FBTyxJQUFJQyxPQUFKLENBQVksT0FBT0MsT0FBUCxFQUFnQkMsTUFBaEIsS0FBMkI7QUFDMUMsVUFBSTtBQUNBLFlBQUlNLFdBQVcsR0FBR3ZCLFNBQVMsQ0FBQ2MsSUFBSSxDQUFDUixJQUFOLENBQTNCO0FBQ0EsWUFBSWtCLFVBQVUsR0FBR2hCLElBQUksQ0FBQ2lCLEtBQUwsQ0FBV0YsV0FBWCxDQUFqQjs7QUFFQSxZQUFJVCxJQUFJLENBQUNULE1BQUwsR0FBYyxDQUFsQixFQUFxQjtBQUNqQlcsVUFBQUEsT0FBTyxDQUFDUSxVQUFELENBQVA7QUFDSCxTQUZELE1BRU87QUFDSFAsVUFBQUEsTUFBTSxDQUFDLCtCQUFELENBQU47QUFDSDtBQUVKLE9BVkQsQ0FVRSxPQUFPRyxLQUFQLEVBQWM7QUFDWkgsUUFBQUEsTUFBTSxDQUFDLElBQUlJLEtBQUosQ0FBVUQsS0FBVixDQUFELENBQU47QUFDSDtBQUVKLEtBZk0sQ0FBUDtBQWdCSDs7QUEzRU87O0FBK0VaTSxNQUFNLENBQUNDLE9BQVAsQ0FBZTFCLEtBQWYsR0FBdUJBLEtBQXZCLEMsQ0FBaUQiLCJzb3VyY2VSb290IjoiL1VzZXJzL3N0b2NrYml0L0Rvd25sb2Fkcy9wcm9qZWN0XzFfdjJfYm9pbGVycGxhdGUvc3JjLyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogICAgICAgICAgICAgICAgICAgICAgICAgIEJsb2NrIGNsYXNzXG4gKiAgVGhlIEJsb2NrIGNsYXNzIGlzIGEgbWFpbiBjb21wb25lbnQgaW50byBhbnkgQmxvY2tjaGFpbiBwbGF0Zm9ybSxcbiAqICBpdCB3aWxsIHN0b3JlIHRoZSBkYXRhIGFuZCBhY3QgYXMgYSBkYXRhc2V0IGZvciB5b3VyIGFwcGxpY2F0aW9uLlxuICogIFRoZSBjbGFzcyB3aWxsIGV4cG9zZSBhIG1ldGhvZCB0byB2YWxpZGF0ZSB0aGUgZGF0YS4uLiBUaGUgYm9keSBvZlxuICogIHRoZSBibG9jayB3aWxsIGNvbnRhaW4gYW4gT2JqZWN0IHRoYXQgY29udGFpbiB0aGUgZGF0YSB0byBiZSBzdG9yZWQsXG4gKiAgdGhlIGRhdGEgc2hvdWxkIGJlIHN0b3JlZCBlbmNvZGVkLlxuICogIEFsbCB0aGUgZXhwb3NlZCBtZXRob2RzIHNob3VsZCByZXR1cm4gYSBQcm9taXNlIHRvIGFsbG93IGFsbCB0aGUgbWV0aG9kc1xuICogIHJ1biBhc3luY2hyb25vdXMuXG4gKi9cblxuY29uc3QgU0hBMjU2ID0gcmVxdWlyZSgnY3J5cHRvLWpzL3NoYTI1NicpO1xuY29uc3QgaGV4MmFzY2lpID0gcmVxdWlyZSgnaGV4MmFzY2lpJyk7XG5cbmNsYXNzIEJsb2NrIHtcblxuICAgIC8vIENvbnN0cnVjdG9yIC0gYXJndW1lbnQgZGF0YSB3aWxsIGJlIHRoZSBvYmplY3QgY29udGFpbmluZyB0aGUgdHJhbnNhY3Rpb24gZGF0YVxuXHRjb25zdHJ1Y3RvcihkYXRhKXtcblx0XHR0aGlzLmhhc2ggPSBudWxsOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBIYXNoIG9mIHRoZSBibG9ja1xuXHRcdHRoaXMuaGVpZ2h0ID0gMDsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEJsb2NrIEhlaWdodCAoY29uc2VjdXRpdmUgbnVtYmVyIG9mIGVhY2ggYmxvY2spXG5cdFx0dGhpcy5ib2R5ID0gQnVmZmVyKEpTT04uc3RyaW5naWZ5KGRhdGEpKS50b1N0cmluZygnaGV4Jyk7ICAgLy8gV2lsbCBjb250YWluIHRoZSB0cmFuc2FjdGlvbnMgc3RvcmVkIGluIHRoZSBibG9jaywgYnkgZGVmYXVsdCBpdCB3aWxsIGVuY29kZSB0aGUgZGF0YVxuXHRcdHRoaXMudGltZSA9IDA7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRpbWVzdGFtcCBmb3IgdGhlIEJsb2NrIGNyZWF0aW9uXG5cdFx0dGhpcy5wcmV2aW91c0Jsb2NrSGFzaCA9IG51bGw7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gUmVmZXJlbmNlIHRvIHRoZSBwcmV2aW91cyBCbG9jayBIYXNoXG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogIHZhbGlkYXRlKCkgbWV0aG9kIHdpbGwgdmFsaWRhdGUgaWYgdGhlIGJsb2NrIGhhcyBiZWVuIHRhbXBlcmVkIG9yIG5vdC5cbiAgICAgKiAgQmVlbiB0YW1wZXJlZCBtZWFucyB0aGF0IHNvbWVvbmUgZnJvbSBvdXRzaWRlIHRoZSBhcHBsaWNhdGlvbiB0cmllZCB0byBjaGFuZ2VcbiAgICAgKiAgdmFsdWVzIGluIHRoZSBibG9jayBkYXRhIGFzIGEgY29uc2VjdWVuY2UgdGhlIGhhc2ggb2YgdGhlIGJsb2NrIHNob3VsZCBiZSBkaWZmZXJlbnQuXG4gICAgICogIFN0ZXBzOlxuICAgICAqICAxLiBSZXR1cm4gYSBuZXcgcHJvbWlzZSB0byBhbGxvdyB0aGUgbWV0aG9kIGJlIGNhbGxlZCBhc3luY2hyb25vdXMuXG4gICAgICogIDIuIFNhdmUgdGhlIGluIGF1eGlsaWFyeSB2YXJpYWJsZSB0aGUgY3VycmVudCBoYXNoIG9mIHRoZSBibG9jayAoYHRoaXNgIHJlcHJlc2VudCB0aGUgYmxvY2sgb2JqZWN0KVxuICAgICAqICAzLiBSZWNhbGN1bGF0ZSB0aGUgaGFzaCBvZiB0aGUgZW50aXJlIGJsb2NrIChVc2UgU0hBMjU2IGZyb20gY3J5cHRvLWpzIGxpYnJhcnkpXG4gICAgICogIDQuIENvbXBhcmUgaWYgdGhlIGF1eGlsaWFyeSBoYXNoIHZhbHVlIGlzIGRpZmZlcmVudCBmcm9tIHRoZSBjYWxjdWxhdGVkIG9uZS5cbiAgICAgKiAgNS4gUmVzb2x2ZSB0cnVlIG9yIGZhbHNlIGRlcGVuZGluZyBpZiBpdCBpcyB2YWxpZCBvciBub3QuXG4gICAgICogIE5vdGU6IHRvIGFjY2VzcyB0aGUgY2xhc3MgdmFsdWVzIGluc2lkZSBhIFByb21pc2UgY29kZSB5b3UgbmVlZCB0byBjcmVhdGUgYW4gYXV4aWxpYXJ5IHZhbHVlIGBsZXQgc2VsZiA9IHRoaXM7YFxuICAgICAqL1xuICAgIHZhbGlkYXRlKCkge1xuICAgICAgICBsZXQgc2VsZiA9IHRoaXM7XG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIC8vIFNhdmUgaW4gYXV4aWxpYXJ5IHZhcmlhYmxlIHRoZSBjdXJyZW50IGJsb2NrIGhhc2hcbiAgICAgICAgICAgICAgICBsZXQgc3RyaW5nID0gSlNPTi5zdHJpbmdpZnkoc2VsZilcbiAgICAgICAgICAgICAgICBsZXQgcmVjYWxjdWxhdGVkSGFzaCA9IFNIQTI1NihzdHJpbmcpXG5cbiAgICAgICAgICAgICAgICAvLyBSZWNhbGN1bGF0ZSB0aGUgaGFzaCBvZiB0aGUgQmxvY2tcbiAgICAgICAgICAgICAgICAvLyBDb21wYXJpbmcgaWYgdGhlIGhhc2hlcyBjaGFuZ2VkXG4gICAgICAgICAgICAgICAgLy8gUmV0dXJuaW5nIHRoZSBCbG9jayBpcyB2YWxpZFxuICAgICAgICAgICAgICAgIC8vIGRvIGEgdGhpbmcsIHBvc3NpYmx5IGFzeW5jLCB0aGVu4oCmXG4gICAgICAgICAgICAgICAgcmVzb2x2ZShzZWxmLmhhc2ggPT0gcmVjYWxjdWxhdGVkSGFzaCk7XG5cbiAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgcmVqZWN0KG5ldyBFcnJvcihlcnJvcikpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiAgQXV4aWxpYXJ5IE1ldGhvZCB0byByZXR1cm4gdGhlIGJsb2NrIGJvZHkgKGRlY29kaW5nIHRoZSBkYXRhKVxuICAgICAqICBTdGVwczpcbiAgICAgKlxuICAgICAqICAxLiBVc2UgaGV4MmFzY2lpIG1vZHVsZSB0byBkZWNvZGUgdGhlIGRhdGFcbiAgICAgKiAgMi4gQmVjYXVzZSBkYXRhIGlzIGEgamF2YXNjcmlwdCBvYmplY3QgdXNlIEpTT04ucGFyc2Uoc3RyaW5nKSB0byBnZXQgdGhlIEphdmFzY3JpcHQgT2JqZWN0XG4gICAgICogIDMuIFJlc29sdmUgd2l0aCB0aGUgZGF0YSBhbmQgbWFrZSBzdXJlIHRoYXQgeW91IGRvbid0IG5lZWQgdG8gcmV0dXJuIHRoZSBkYXRhIGZvciB0aGUgYGdlbmVzaXMgYmxvY2tgXG4gICAgICogICAgIG9yIFJlamVjdCB3aXRoIGFuIGVycm9yLlxuICAgICAqL1xuICAgIGdldEJEYXRhKCkge1xuICAgICAgICAvLyBHZXR0aW5nIHRoZSBlbmNvZGVkIGRhdGEgc2F2ZWQgaW4gdGhlIEJsb2NrXG4gICAgICAgIC8vIERlY29kaW5nIHRoZSBkYXRhIHRvIHJldHJpZXZlIHRoZSBKU09OIHJlcHJlc2VudGF0aW9uIG9mIHRoZSBvYmplY3RcbiAgICAgICAgLy8gUGFyc2UgdGhlIGRhdGEgdG8gYW4gb2JqZWN0IHRvIGJlIHJldHJpZXZlLlxuXG4gICAgICAgIC8vIFJlc29sdmUgd2l0aCB0aGUgZGF0YSBpZiB0aGUgb2JqZWN0IGlzbid0IHRoZSBHZW5lc2lzIGJsb2NrXG4gICAgICAgIGxldCBzZWxmID0gdGhpcztcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGFzeW5jIChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgbGV0IGRlY29kZWREYXRhID0gaGV4MmFzY2lpKHNlbGYuYm9keSk7XG4gICAgICAgICAgICAgICAgbGV0IHBhcnNlZERhdGEgPSBKU09OLnBhcnNlKGRlY29kZWREYXRhKTtcblxuICAgICAgICAgICAgICAgIGlmIChzZWxmLmhlaWdodCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShwYXJzZWREYXRhKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByZWplY3QoXCJDYW5ub3QgcmV0cmlldmUgZ2VuZXNpcyBibG9ja1wiKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgcmVqZWN0KG5ldyBFcnJvcihlcnJvcikpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgIH0pO1xuICAgIH1cblxufVxuXG5tb2R1bGUuZXhwb3J0cy5CbG9jayA9IEJsb2NrOyAgICAgICAgICAgICAgICAgICAgLy8gRXhwb3NpbmcgdGhlIEJsb2NrIGNsYXNzIGFzIGEgbW9kdWxlXG4iXX0=",
    "map": {
      "version": 3,
      "sources": [
        "block.js"
      ],
      "names": [
        "SHA256",
        "require",
        "hex2ascii",
        "Block",
        "constructor",
        "data",
        "hash",
        "height",
        "body",
        "Buffer",
        "JSON",
        "stringify",
        "toString",
        "time",
        "previousBlockHash",
        "validate",
        "self",
        "Promise",
        "resolve",
        "reject",
        "string",
        "recalculatedHash",
        "error",
        "Error",
        "getBData",
        "decodedData",
        "parsedData",
        "parse",
        "module",
        "exports"
      ],
      "mappings": ";;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA,MAAMA,MAAM,GAAGC,OAAO,CAAC,kBAAD,CAAtB;;AACA,MAAMC,SAAS,GAAGD,OAAO,CAAC,WAAD,CAAzB;;AAEA,MAAME,KAAN,CAAY;AAER;AACHC,EAAAA,WAAW,CAACC,IAAD,EAAM;AAChB,SAAKC,IAAL,GAAY,IAAZ,CADgB,CAC4C;;AAC5D,SAAKC,MAAL,GAAc,CAAd,CAFgB,CAE4C;;AAC5D,SAAKC,IAAL,GAAYC,MAAM,CAACC,IAAI,CAACC,SAAL,CAAeN,IAAf,CAAD,CAAN,CAA6BO,QAA7B,CAAsC,KAAtC,CAAZ,CAHgB,CAG4C;;AAC5D,SAAKC,IAAL,GAAY,CAAZ,CAJgB,CAI4C;;AAC5D,SAAKC,iBAAL,GAAyB,IAAzB,CALgB,CAK4C;AACzD;AAED;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AACIC,EAAAA,QAAQ,GAAG;AACP,QAAIC,IAAI,GAAG,IAAX;AACA,WAAO,IAAIC,OAAJ,CAAY,CAACC,OAAD,EAAUC,MAAV,KAAqB;AACpC,UAAI;AACA;AACA,YAAIC,MAAM,GAAGV,IAAI,CAACC,SAAL,CAAeK,IAAf,CAAb;AACA,YAAIK,gBAAgB,GAAGrB,MAAM,CAACoB,MAAD,CAA7B,CAHA,CAKA;AACA;AACA;AACA;;AACAF,QAAAA,OAAO,CAACF,IAAI,CAACV,IAAL,IAAae,gBAAd,CAAP;AAEH,OAXD,CAWE,OAAOC,KAAP,EAAc;AACZH,QAAAA,MAAM,CAAC,IAAII,KAAJ,CAAUD,KAAV,CAAD,CAAN;AACH;AACJ,KAfM,CAAP;AAgBH;AAED;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AACIE,EAAAA,QAAQ,GAAG;AACP;AACA;AACA;AAEA;AACA,QAAIR,IAAI,GAAG,IAAX;AACA,WAAO,IAAIC,OAAJ,CAAY,OAAOC,OAAP,EAAgBC,MAAhB,KAA2B;AAC1C,UAAI;AACA,YAAIM,WAAW,GAAGvB,SAAS,CAACc,IAAI,CAACR,IAAN,CAA3B;AACA,YAAIkB,UAAU,GAAGhB,IAAI,CAACiB,KAAL,CAAWF,WAAX,CAAjB;;AAEA,YAAIT,IAAI,CAACT,MAAL,GAAc,CAAlB,EAAqB;AACjBW,UAAAA,OAAO,CAACQ,UAAD,CAAP;AACH,SAFD,MAEO;AACHP,UAAAA,MAAM,CAAC,+BAAD,CAAN;AACH;AAEJ,OAVD,CAUE,OAAOG,KAAP,EAAc;AACZH,QAAAA,MAAM,CAAC,IAAII,KAAJ,CAAUD,KAAV,CAAD,CAAN;AACH;AAEJ,KAfM,CAAP;AAgBH;;AA3EO;;AA+EZM,MAAM,CAACC,OAAP,CAAe1B,KAAf,GAAuBA,KAAvB,C,CAAiD",
      "sourceRoot": "/Users/stockbit/Downloads/project_1_v2_boilerplate/src/",
      "sourcesContent": [
        "/**\n *                          Block class\n *  The Block class is a main component into any Blockchain platform,\n *  it will store the data and act as a dataset for your application.\n *  The class will expose a method to validate the data... The body of\n *  the block will contain an Object that contain the data to be stored,\n *  the data should be stored encoded.\n *  All the exposed methods should return a Promise to allow all the methods\n *  run asynchronous.\n */\n\nconst SHA256 = require('crypto-js/sha256');\nconst hex2ascii = require('hex2ascii');\n\nclass Block {\n\n    // Constructor - argument data will be the object containing the transaction data\n\tconstructor(data){\n\t\tthis.hash = null;                                           // Hash of the block\n\t\tthis.height = 0;                                            // Block Height (consecutive number of each block)\n\t\tthis.body = Buffer(JSON.stringify(data)).toString('hex');   // Will contain the transactions stored in the block, by default it will encode the data\n\t\tthis.time = 0;                                              // Timestamp for the Block creation\n\t\tthis.previousBlockHash = null;                              // Reference to the previous Block Hash\n    }\n\n    /**\n     *  validate() method will validate if the block has been tampered or not.\n     *  Been tampered means that someone from outside the application tried to change\n     *  values in the block data as a consecuence the hash of the block should be different.\n     *  Steps:\n     *  1. Return a new promise to allow the method be called asynchronous.\n     *  2. Save the in auxiliary variable the current hash of the block (`this` represent the block object)\n     *  3. Recalculate the hash of the entire block (Use SHA256 from crypto-js library)\n     *  4. Compare if the auxiliary hash value is different from the calculated one.\n     *  5. Resolve true or false depending if it is valid or not.\n     *  Note: to access the class values inside a Promise code you need to create an auxiliary value `let self = this;`\n     */\n    validate() {\n        let self = this;\n        return new Promise((resolve, reject) => {\n            try {\n                // Save in auxiliary variable the current block hash\n                let string = JSON.stringify(self)\n                let recalculatedHash = SHA256(string)\n\n                // Recalculate the hash of the Block\n                // Comparing if the hashes changed\n                // Returning the Block is valid\n                // do a thing, possibly async, then\n                resolve(self.hash == recalculatedHash);\n\n            } catch (error) {\n                reject(new Error(error));\n            }\n        });\n    }\n\n    /**\n     *  Auxiliary Method to return the block body (decoding the data)\n     *  Steps:\n     *\n     *  1. Use hex2ascii module to decode the data\n     *  2. Because data is a javascript object use JSON.parse(string) to get the Javascript Object\n     *  3. Resolve with the data and make sure that you don't need to return the data for the `genesis block`\n     *     or Reject with an error.\n     */\n    getBData() {\n        // Getting the encoded data saved in the Block\n        // Decoding the data to retrieve the JSON representation of the object\n        // Parse the data to an object to be retrieve.\n\n        // Resolve with the data if the object isn't the Genesis block\n        let self = this;\n        return new Promise(async (resolve, reject) => {\n            try {\n                let decodedData = hex2ascii(self.body);\n                let parsedData = JSON.parse(decodedData);\n\n                if (self.height > 0) {\n                    resolve(parsedData);\n                } else {\n                    reject(\"Cannot retrieve genesis block\");\n                }\n\n            } catch (error) {\n                reject(new Error(error));\n            }\n\n        });\n    }\n\n}\n\nmodule.exports.Block = Block;                    // Exposing the Block class as a module\n"
      ]
    },
    "sourceType": "script",
    "mtime": 1622013280325
  }
}